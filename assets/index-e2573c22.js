var ir=Object.defineProperty;var sr=(a,t,e)=>t in a?ir(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var W=(a,t,e)=>(sr(a,typeof t!="symbol"?t+"":t,e),e),de=(a,t,e)=>{if(!t.has(a))throw TypeError("Cannot "+e)};var i=(a,t,e)=>(de(a,t,"read from private field"),e?e.call(a):t.get(a)),y=(a,t,e)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,e)},u=(a,t,e,r)=>(de(a,t,"write to private field"),r?r.call(a,e):t.set(a,e),e);var tt=(a,t,e)=>(de(a,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();let qt,ee,at,At,Qt,ye=Object,ft=ye.getPrototypeOf,xe=document,Re={isConnected:1},Se={},nr=ft(Re),Pe=ft(ft),Le=(a,t,e,r)=>(a??(setTimeout(e,r),new Set)).add(t),je=(a,t,e)=>{let r=at;at=t;try{return a(e)}catch(s){return console.error(s),e}finally{at=r}},re=a=>a.filter(t=>{var e;return(e=t.t)==null?void 0:e.isConnected}),He=a=>Qt=Le(Qt,a,()=>{for(let t of Qt)t.l=re(t.l),t.o=re(t.o);Qt=qt},1e3),ue={get val(){return at==null||at.add(this),this.i},get oldVal(){return at==null||at.add(this),this.u},set val(a){let t=this;if(a!==t.i){t.i=a;let e=[...t.o=re(t.o)];for(let r of e)We(r.f,r.s,r.t),r.t=qt;t.l.length?ee=Le(ee,t,ar):t.u=a}}},Ge=a=>({__proto__:ue,i:a,u:a,l:[],o:[]}),Ne=a=>ft(a??0)===ue,kt=(a,t)=>{let e=new Set,r={f:a},s=At;At=[];let n=je(a,e,t);n=(n??xe).nodeType?n:new Text(n);for(let o of e)He(o),o.l.push(r);for(let o of At)o.t=n;return At=s,r.t=n},We=(a,t=Ge(),e)=>{let r=new Set,s={f:a,s:t};s.t=e??(At==null?void 0:At.push(s))??Re,t.val=je(a,r);for(let n of r)He(n),n.o.push(s);return t},Ue=(a,...t)=>{for(let e of t.flat(1/0)){let r=ft(e??0),s=r===ue?kt(()=>e.val):r===Pe?kt(e):e;s!=qt&&a.append(s)}return a},Ce=a=>new Proxy((t,...e)=>{var o;let[r,...s]=ft(e[0]??0)===nr?e:[{},...e],n=a?xe.createElementNS(a,t):xe.createElement(t);for(let[l,c]of ye.entries(r)){let h=w=>w?ye.getOwnPropertyDescriptor(w,l)??h(ft(w)):qt,f=t+","+l,m=Se[f]??(Se[f]=((o=h(ft(n)))==null?void 0:o.set)??0),g=m?m.bind(n):n.setAttribute.bind(n,l),d=ft(c??0);d===ue?kt(()=>(g(c.val),n)):d!==Pe||l.startsWith("on")&&!c.h?g(c):kt(()=>(g(c()),n))}return Ue(n,...s)},{get:(t,e)=>t.bind(qt,e)}),Ve=(a,t)=>t?t!==a&&a.replaceWith(t):a.remove(),ar=()=>{let a=[...ee].filter(t=>t.i!==t.u);ee=qt;for(let t of new Set(a.flatMap(e=>e.l=re(e.l))))Ve(t.t,kt(t.f,t.t)),t.t=qt;for(let t of a)t.u=t.i};const et={add:Ue,_:a=>(a.h=1,a),tags:Ce(),tagsNS:Ce,state:Ge,val:a=>Ne(a)?a.val:a,oldVal:a=>Ne(a)?a.oldVal:a,derive:We,hydrate:(a,t)=>Ve(a,kt(t,a))};class or{constructor(t){W(this,"parent");W(this,"point");W(this,"left");W(this,"right");this.point=t,this.parent=null,this.left=null,this.right=null}}var U,V,dt,le,Be,wt,Ft;class lr{constructor(t,e={clone:!0}){y(this,le);y(this,wt);y(this,U,void 0);y(this,V,void 0);y(this,dt,void 0);var r;u(this,U,t?e!=null&&e.clone?[...t]:t:[]),u(this,V,((r=t==null?void 0:t[0])==null?void 0:r.length)??0),u(this,dt,tt(this,wt,Ft).call(this,i(this,U),0,null))}get dimensions(){return i(this,V)}get tree(){return i(this,dt)}[Symbol.iterator](){return i(this,U)[Symbol.iterator]()}insert(t){if(!i(this,U).length)u(this,V,t.length);else if(i(this,V)!==t.length)throw new TypeError(`Point [${t}] has ${t.length} dimensions, but should have ${i(this,V)}`);i(this,U).push(t),u(this,dt,tt(this,wt,Ft).call(this,i(this,U),0,null))}remove(t){if(!i(this,U).length||t.length!==i(this,V))return;const e=this.nearestNeighbor(t);if(e.distance===0){const r=i(this,U).findIndex(s=>s===e.point);return i(this,U).splice(r,1),u(this,dt,tt(this,wt,Ft).call(this,i(this,U),0,null)),e.point}}has(t){return t.length!==i(this,V)?!1:this.nearestNeighbor(t).distance===0}size(){return i(this,U).length}nearestNeighbor(t){function e(o,l){return l?o.reduce((c,h,f)=>c+(h-l[f])**2,0):1/0}function r(o,l){return o&&(!l||e(t,o.point)<=e(t,l.point))?o:l}const s=(o,l)=>{if(!o)return null;let c,h;t[l%i(this,V)]<=o.point[l%this.dimensions]?(c=o.left,h=o.right):(c=o.right,h=o.left);let f=s(c,l+1),m=r(f,o);const g=e(t,m==null?void 0:m.point),d=t[l%i(this,V)]-o.point[l%i(this,V)];return g>=d**2&&(f=s(h,l+1),m=r(f,m)),m},n=s(i(this,dt),0);return{point:(n==null?void 0:n.point)??null,distance:Math.sqrt(e(t,n==null?void 0:n.point))}}}U=new WeakMap,V=new WeakMap,dt=new WeakMap,le=new WeakSet,Be=function(t){const e=Math.floor(t.length/2);return[t[e],e]},wt=new WeakSet,Ft=function(t,e,r){if(t.length===0)return null;t.sort((c,h)=>c[e]-h[e]);const[s,n]=tt(this,le,Be).call(this,t),o=(e+1)%i(this,V),l=new or(s);return l.parent=r,l.left=tt(this,wt,Ft).call(this,t.slice(0,n),o,l),l.right=tt(this,wt,Ft).call(this,t.slice(n+1),o,l),l};function cr(a,...t){try{return new new Proxy(a,{construct(){return{}}})(...t??[]),!0}catch{return!1}}function qe(a,t,e){if(a>t)throw new RangeError("Minimum must be less than maximum");if(!(typeof e>"u")&&(a>e||e>t))throw new RangeError("Value must be between minimum and maximum")}function hr(...a){if(a.some(t=>!Number.isInteger(t)))throw new RangeError("Arguments must be integers")}function Xe(...a){if(a.some(t=>t<0||!Number.isInteger(t)))throw new RangeError("Arguments must be natural numbers")}function Fe(...a){if(a.some(t=>t<1||!Number.isInteger(t)))throw new RangeError("Arguments must be counting numbers")}var zt,It;const H=class H{constructor(t=0,e=0){y(this,zt,void 0);y(this,It,void 0);u(this,zt,t),u(this,It,e)}get real(){return i(this,zt)}get imaginary(){return i(this,It)}static from(t){return t instanceof H?t:new H(t.valueOf())}add(t){const e=H.from(t);return new H(this.real+e.real,this.imaginary+e.imaginary)}sub(t){const e=H.from(t);return new H(this.real-e.real,this.imaginary-e.imaginary)}mul(t){const e=H.from(t);return new H(this.real*e.real-this.imaginary*e.imaginary,this.real*e.imaginary+this.imaginary*e.real)}div(t){const e=H.from(t),r=e.conjugate(),s=this.mul(r),n=e.real**2+e.imaginary**2;return new H(s.real/n,s.imaginary/n)}pow(t){let e=this;for(let r=t.valueOf()-1;r>0;r--)e=e.mul(this);return e}abs(){return Math.sign(i(this,zt))===Math.sign(i(this,It))?this:new H(Math.abs(i(this,zt)),Math.abs(i(this,It)))}eq(...t){const e=H.from(...t);return this.real===e.real&&this.imaginary===e.imaginary}conjugate(){return new H(this.real,-1*this.imaginary)}valueOf(){return this.real}toFixed(t){return this.real.toFixed(t)}toExponential(t){return this.real.toExponential(t)}toPrecision(t){return this.real.toPrecision(t)}toString(t){return`${this.real===0&&this.imaginary!==0?"":this.real}${this.imaginary!==0?(this.imaginary===1?"+":this.imaginary.toLocaleString("en-US",{signDisplay:this.real===0?"auto":"always"}))+"i":""}`}toLocaleString(t,e){return this.toString()}[Symbol.toPrimitive](t){return t==="string"?this.toString():this.real}get[Symbol.toStringTag](){return"Complex"}};zt=new WeakMap,It=new WeakMap;let pe=H;const ur=256-1,fr=65536-1,mt=-1>>>0,mr=128-1,dr=-mr-1,wr=32768-1,gr=-wr-1,Je=(mt+1)/2-1,yr=-Je-1;var D;const x=class x{constructor(t){y(this,D,void 0);u(this,D,t)}get rows(){return i(this,D).length}get cols(){return i(this,D)[0].length}get size(){return this.rows*this.cols}get data(){return i(this,D)}static zero(t){if(t<=0)throw new RangeError(`Invalid matrix size [${t}x${t}]`);const e=new Array(t).fill(null).map(()=>new Array(t).fill(0));return new x(e)}static identity(t){if(t<=0)throw new RangeError(`Invalid matrix size [${t}x${t}]`);const e=x.zero(t);for(let r=0;r<t;r++)e.data[r][r]=1;return e}static withSize(t,e,r=0){if(t<=0||e<=0)throw new RangeError(`Invalid size [${t} x ${e}]`);const s=new Array(t).fill(null).map(()=>new Array(e).fill(r));return new x(s)}static fromDiagonal(t){const e=t.length;if(e<=0)throw new RangeError(`Invalid size [${e} x ${e}]`);const r=x.zero(e);for(let s=0;s<e;s++)i(r,D)[s][s]=t[s];return r}static fromMTX(t,e={}){const[r,...s]=t.split(/\n/),[n,o,l,c,h]=r.split(/\s+/).map(w=>w.toLowerCase());if(n!=="%%matrixmarket")throw new Error(`Unrecognized header '${n}'`);if(o!=="matrix")throw new Error(`Unrecognized object '${o}'`);if(!["coordinate","array"].includes(l))throw new Error(`Unrecognized format '${l}'`);if(l==="array"&&c==="pattern")throw new Error("Format 'array' is incompatible with symmetry type 'pattern'");if(e.format&&l!==e.format)throw new Error(`Specified format '${e.format}' does not match data format '${l}'`);if(!["real","complex","integer","pattern"].includes(c))throw new Error(`Unrecognized field type '${c}'`);if(h==="hermitian"&&c!=="complex"||c==="pattern"&&!["general","symmetric"].includes(h))throw new Error(`Symmetry type '${h}' is incompatible with field type '${c}'`);if(e.field&&c!==e.field)throw new Error(`Specified field type '${e.field}' does not match data field type '${c}'`);if(!["general","symmetric","skew-symmetric","hermitian"].includes(h))throw new Error(`Unrecognized symmetry type '${h}'`);if(h!=="general"||e.symmetry&&h!==e.symmetry)throw new Error("Type");for(;s[0].startsWith("%");)s.shift();const[f,m,g]=s.shift().split(/\s/).map(w=>parseInt(w));if(f!==m&&h!=="general")throw new Error(`Symmetry type '${h}' is unsupported for non-square matrices`);const d=x.withSize(f,m);for(let w=0,$=0;w<s.length;w++){const S=s[w];if(S.startsWith("%")||!S.trim())continue;let[N,A,q,F]=S.split(/\s+/).map(Number);if(l==="array"&&(q=N,F=A,[N,A]=[$%f+1,Math.floor($/f)+1],$++),!Number.isInteger(N)||!Number.isInteger(A))throw new Error(`Bad matrix coordinate ${N},${A}
${S}`);if(Number.isNaN(q))throw new Error(`Bad value '${q}`);if(Number.isNaN(F))throw new Error(`Bad value ${F}`);let T=q;switch(c){case"integer":{if(!Number.isInteger(q))throw new Error(`Non-integer value '${q}'`);break}case"complex":throw Number.isNaN(F)?new Error(`Invalid imaginary component '${F}'`):new Error("TODO");case"pattern":throw new Error("TODO")}i(d,D)[N-1][A-1]=T}return d}static isMatrixLike(t,...e){var n;if(t instanceof x)return!e.length||t.rows===e[0]&&t.cols===e[1];const[r,s]=e;return Array.isArray(t)&&Array.isArray(t[0])&&typeof((n=t[0][0])==null?void 0:n.valueOf())=="number"&&(!r&&!s||t.length===r&&t[0].length===s)}isSquare(){return this.rows===this.cols}isOrthogonal(){return this.isSquare()?this.transpose().mul(this).eq(x.identity(this.cols)):!1}at(t,e){var r;return(r=i(this,D).at(t))==null?void 0:r.at(e)}row(t){return this.data.at(t)}col(t){if(!(t>=this.cols))return this.data.map(e=>e.at(t))}clone(){const t=i(this,D).map(e=>[...e]);return new x(t)}submatrix({removeRows:t,removeCols:e,xywh:r}){if(r){const[s,n,o,l]=r,c=i(this,D).slice(n,l&&l+n).map(h=>h.slice(s,o&&o+s));return new x(c)}else{const s=i(this,D).reduce((n,o,l)=>{if(!t.includes(l)){const c=o.reduce((h,f,m)=>(e.includes(m)||h.push(f),h),[]);n.push(c)}return n},[]);return new x(s)}}trace(){if(!this.isSquare())throw new Error(`Cannot find trace of non-square matrix [${this.rows}x${this.cols}]`);let t=0;for(let e=0;e<this.rows;e++)t+=this.data[e][e];return t}determinant(){if(!this.isSquare())throw new Error(`Cannot find determinant of non-square matrix [${this.rows}x${this.cols}]`);if(this.size===1)return this.at(0,0);if(this.rows===2&&this.cols===2)return this.at(0,0)*this.at(1,1)-this.at(1,0)*this.at(0,1);if(this.rows===3&&this.cols===3)return this.at(0,0)*this.at(1,1)*this.at(2,2)+this.at(0,1)*this.at(1,2)*this.at(2,0)+this.at(0,2)*this.at(1,0)*this.at(2,1)-this.at(0,2)*this.at(1,1)*this.at(2,0)-this.at(0,1)*this.at(1,0)*this.at(2,2)-this.at(0,0)*this.at(1,2)*this.at(2,1);let t=0;for(let e=0;e<this.rows;e++){const r=this.submatrix({removeRows:[0],removeCols:[e]}),s=(-1)**(e%2),n=r.determinant();if(n===void 0)throw new Error("Failed to find subdeterminant");t+=this.at(0,e)*s*n}return t}augment(t){const e=t instanceof x?t:x.isMatrixLike(t)?new x(t):null;if(!e)throw new Error("Argument is not matrix-like.");if(e.rows!==this.rows)throw new Error(`Cannot augment matrix [${this.rows}x${this.cols}] by [${e.rows}x${e.cols}]`);const r=i(this,D).map((s,n)=>s.concat(e.row(n)));return new x(r)}inverse(t=5){if(!this.isSquare())throw new Error(`Cannot invert non-square matrix [${this.rows}x${this.cols}]`);if(!this.determinant())throw new Error("Cannot invert singular matrix");const e=this.augment(x.identity(this.rows)).data;e.forEach((s,n)=>{const o=s[n];o!==0&&e.forEach((l,c)=>{if(c===n||l[n]===0)return;const h=-1*(l[n]/o);e[c]=l.map((f,m)=>f+h*s[m])})}),e.forEach((s,n)=>{if(s[n]===1)return;const o=s[n]===0?1:1/s[n];e[n]=s.map(l=>l*o)});const r=new x(e).submatrix({xywh:[this.cols,0,this.cols,this.rows]});if(this.mul(r).eq(x.identity(this.rows),t))return r}transpose(){const t=x.withSize(this.cols,this.rows);for(let e=0;e<this.cols;e++)for(let r=0;r<this.rows;r++)i(t,D)[e][r]=i(this,D)[r][e];return t}vectorize(){return i(this,D).flat()}add(t){if(t instanceof x){if(this.cols!==t.cols||this.rows!==t.rows)throw new RangeError(`Cannot add receiver [${this.rows}x${this.cols}] to argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)+t.at(r,s);return new x(e)}else if(x.isMatrixLike(t)){if(this.rows!==t.length||this.cols!==t[0].length)throw new RangeError(`Cannot add receiver [${this.rows}x${this.cols}] to argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(this.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)+t[r][s];return new x(e)}else throw new TypeError(`Invalid argument ${t}`)}sub(t){if(t instanceof x){if(this.cols!==t.cols||this.rows!==t.rows)throw new RangeError(`Cannot subtract from receiver [${this.rows}x${this.cols}] argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)-t.at(r,s);return new x(e)}else if(x.isMatrixLike(t)){if(this.rows!==t.length||this.cols!==t[0].length)throw new RangeError(`Cannot subtract from receiver [${this.rows}x${this.cols}] argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(this.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)-t[r][s];return new x(e)}else throw new TypeError(`Invalid argument ${t}`)}mul(t){if(t instanceof x){if(this.cols!==t.rows)throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<t.cols;s++)e[r][s]=i(this,D)[r].reduce((n,o,l)=>{const c=o*t.at(l,s);return n+c},0);return new x(e)}else if(x.isMatrixLike(t)){if(this.cols!==t.length||t[0].length<=0)throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t[0].length));for(let r=0;r<this.rows;r++)for(let s=0;s<t[0].length;s++)e[r][s]=i(this,D)[r].reduce((n,o,l)=>{const c=o*t[l][s];return n+c},0);return new x(e)}else{if(Array.isArray(t))throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.length}x?]`);return new x(i(this,D).map(e=>e.map(r=>r*t)))}}pow(t){if(t<0)throw new RangeError("Negative exponentiation is not permitted. If matrix is invertible, first invert then use positive exponentiation.");if(!this.isSquare())throw new Error("Exponentiation is only defined for square matricies");if(t===0)return x.identity(this.rows);{let e=this;for(let r=t-1;r>0;r--)e=e.mul(this);return e}}eq(t,e=5){function r(s,n){return e?Math.abs(s-n)<1/10**e:s===n}return t instanceof x?x.isMatrixLike(t.data,this.rows,this.cols)?t.data.every((s,n)=>s.every((o,l)=>r(o,this.at(n,l)))):!1:x.isMatrixLike(t,this.rows,this.cols)?t.every((s,n)=>s.every((o,l)=>r(o,this.at(n,l)))):!1}dot(t){if(this.cols!==1||!x.isMatrixLike(t))throw new Error("Cannot compute dot product of non column-vector matrices.");return this.transpose().mul(t).at(0,0)}[Symbol.iterator](){return i(this,D)[Symbol.iterator]()}};D=new WeakMap;let bt=x;var Bt,ve;const Vt=class Vt{constructor(...t){throw new Error("Range contains static methods only and is not meant to be constructed")}static of(t,e){var c;const{from:r,to:s,step:n,produce:o}=tt(c=Vt,Bt,ve).call(c,t,e),l=[];for(let h=r;r<s?h<=s:h>=s;h+=n)l.push(o(h));return l}static*lazy(t,e){var l;const{from:r,to:s,step:n,produce:o}=tt(l=Vt,Bt,ve).call(l,t,e);for(let c=r;r<s?c<=s:c>=s;c+=n)yield o(c)}};Bt=new WeakSet,ve=function(t,e){let{from:r=0,to:s=0,step:n=1}=typeof t=="object"?t:{to:t};if(r===s)throw new Error("Range must be nonzero in size");if(n<=0)throw new Error("Step size must be positive, as its sign is inferred from the range");r>s&&(n*=-1);const o=e?cr(e,r)?l=>new e(l):l=>e(l):l=>l;return{from:r,to:s,step:n,produce:o}},y(Vt,Bt);let ie=Vt;function R(a,t,e){return a+(t-a)*e}function Et(a,t,e){if(0>e||e>1)throw new RangeError("Value must be between 0 and 1 inclusive");return R(a,t,e)}function De(a){if(Xe(a),a<=2)return a;let t=a,e=a;for(;e>1;)e--,t=t*e;return t}var L;class it{constructor(t=Math.random){y(this,L,void 0);u(this,L,t)}bool(){return i(this,L).call(this)>=.5}natural(t=mt-1){return Xe(t),Math.floor(Et(0,t+1,i(this,L).call(this)))}counting(t=mt-1){return Fe(t),Math.floor(Et(1,t+1,i(this,L).call(this)))}u8(){return Math.floor(Et(0,ur+1,i(this,L).call(this)))}u16(){return Math.floor(Et(0,fr+1,i(this,L).call(this)))}u32(){return Math.floor(Et(0,mt+1,i(this,L).call(this)))}i8(){return this.u8()+dr}i16(){return this.u16()+gr}i32(){return this.u32()+yr}integer({min:t=0,max:e=mt}={max:mt}){return hr(t,e),qe(t,e),Math.floor(Et(t,e+1,i(this,L).call(this)))}float({min:t,max:e}={}){if(t===void 0&&e===void 0)return i(this,L).call(this);const r=t??0,s=e??Je;return qe(r,s),Et(r,s+1,i(this,L).call(this))}dice(t){return this.integer({min:1,max:t})}unitVector(t=2){Fe(t);const e=i(this,L).call(this)*2*Math.PI;if(t===1)return[1];if(t===2)return[Math.cos(e),Math.sin(e)];if(t===3){const n=Math.acos(1-2*i(this,L).call(this));return[Math.cos(e)*Math.sin(n),Math.sin(e)*Math.sin(n),Math.cos(n)]}const r=Array(t).fill(null).map(()=>this.float({min:-1,max:1})),s=Math.sqrt(r.reduce((n,o)=>n+o**2,0));return r.map(n=>n/s)}sample(t){const e=t instanceof Set?[...t]:t;if(e.length===0)return;const r=this.natural(e.length-1);return e[r]}take(t){const e=t instanceof Set?[...t]:t;if(e.length===0)return;const r=this.natural(e.length-1),s=e[r];return t instanceof Set?t.delete(s):t.splice(r,1),s}permute(t){for(let e=0;e<t.length-1;e++){const r=e+this.integer({max:t.length-e-1}),s=t[e];t[e]=t[r],t[r]=s}}permutation(t){const e=[...t];for(let r=0;r<=t.length-1;r++){const s=r+this.integer({max:t.length-r-1}),n=e[r];e[r]=e[s],e[s]=n}return e}permutationsOf(t){let e=t instanceof Set?t.size:Array.isArray(t)?t.length:t;return e===0?1:De(e)}derange(t){const e=new Array(t.length).fill(!1);let r=t.length,s=r;for(;s>=2;){if(!e[r-1]){let n=0;do n=this.integer({min:1,max:r-1});while(e[n-1]);const o=t[n-1];t[n-1]=t[r-1],t[r-1]=o,i(this,L).call(this)<(s-1)*this.derangementsOf(s-2)/this.derangementsOf(s)&&(e[n-1]=!0,s--),s--}r--}}derangement(t){const e=[...t];return this.derange(e),e}derangementsOf(t){let e=t instanceof Set?t.size:Array.isArray(t)?t.length:t;return Math.floor((De(e)+1)/Math.E)}}L=new WeakMap;var rt;class Te extends it{constructor(e){super(()=>{u(this,rt,i(this,rt)|0),u(this,rt,i(this,rt)+1831565813|0);let r=Math.imul(i(this,rt)^i(this,rt)>>>15,1|i(this,rt));return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296});y(this,rt,void 0);u(this,rt,e)}}rt=new WeakMap;var St,ot,_,gt;class xr extends it{constructor(e,r,s,n){super(()=>{u(this,St,i(this,St)|0),u(this,ot,i(this,ot)|0),u(this,_,i(this,_)|0),u(this,gt,i(this,gt)|0);const o=(i(this,St)+i(this,ot)|0)+i(this,gt)|0;return u(this,gt,i(this,gt)+1|0),u(this,St,i(this,ot)^i(this,ot)>>>9),u(this,ot,i(this,_)+(i(this,_)<<3)|0),u(this,_,i(this,_)<<21|i(this,_)>>>11),u(this,_,i(this,_)+o|0),(o>>>0)/4294967296});y(this,St,void 0);y(this,ot,void 0);y(this,_,void 0);y(this,gt,void 0);u(this,St,e),u(this,ot,r),u(this,_,s),u(this,gt,n)}}St=new WeakMap,ot=new WeakMap,_=new WeakMap,gt=new WeakMap;var lt;class pr extends it{constructor(e){super(()=>{u(this,lt,i(this,lt)|0),u(this,lt,i(this,lt)+2654435769|0);let r=i(this,lt)^i(this,lt)>>>16;return r=Math.imul(r,569420461),r=r^r>>>15,r=Math.imul(r,1935289751),((r=r^r>>>15)>>>0)/4294967296});y(this,lt,void 0);u(this,lt,e)}}lt=new WeakMap;var yt,ct,xt,ht;class vr extends it{constructor(e,r,s,n){super(()=>{u(this,yt,i(this,yt)|0),u(this,ct,i(this,ct)|0),u(this,xt,i(this,xt)|0),u(this,ht,i(this,ht)|0);let o=i(this,yt)-(i(this,ct)<<27|i(this,ct)>>>5)|0;return u(this,yt,i(this,ct)^(i(this,xt)<<17|s>>>15)),u(this,ct,i(this,xt)+i(this,ht)|0),u(this,xt,i(this,ht)+o|0),u(this,ht,i(this,yt)+o|0),(i(this,ht)>>>0)/4294967296});y(this,yt,void 0);y(this,ct,void 0);y(this,xt,void 0);y(this,ht,void 0);u(this,yt,e),u(this,ct,r),u(this,xt,s),u(this,ht,n)}}yt=new WeakMap,ct=new WeakMap,xt=new WeakMap,ht=new WeakMap;var G,B,j,pt;class br extends it{constructor(e,r,s,n){super(()=>(u(this,G,i(this,G)|0),u(this,B,i(this,B)|0),u(this,j,i(this,j)|0),u(this,pt,i(this,pt)|0),u(this,G,i(this,G)<<16|i(this,G)>>>16),u(this,B,i(this,B)+i(this,j)|0),u(this,G,i(this,G)+i(this,B)|0),u(this,j,i(this,j)^i(this,B)),u(this,j,i(this,j)<<11|i(this,j)>>>21),u(this,B,i(this,B)^i(this,G)),u(this,G,i(this,G)+i(this,j)|0),u(this,B,i(this,j)<<19|i(this,j)>>>13),u(this,j,i(this,j)+i(this,G)|0),u(this,pt,i(this,pt)+38565|0),u(this,B,i(this,B)+i(this,pt)|0),(i(this,G)>>>0)/4294967296));y(this,G,void 0);y(this,B,void 0);y(this,j,void 0);y(this,pt,void 0);u(this,G,e),u(this,B,r),u(this,j,s),u(this,pt,n)}}G=new WeakMap,B=new WeakMap,j=new WeakMap,pt=new WeakMap;var I;const b=class b{constructor(...t){throw new Error("Random contains static methods only and is not meant to be constructed")}static bool(){return i(b,I).bool()}static natural(t=mt){return i(b,I).natural(t)}static counting(t=mt){return i(b,I).counting(t)}static u8(){return i(b,I).u8()}static u16(){return i(b,I).u16()}static u32(){return i(b,I).u32()}static i8(){return i(b,I).i8()}static i16(){return i(b,I).i16()}static i32(){return i(b,I).i32()}static integer(t){return i(b,I).integer(t)}static float(t){return i(b,I).float(t)}static dice(t){return i(b,I).dice(t)}static unitVector(t=2){return i(b,I).unitVector(t)}static sample(t){return i(b,I).sample(t)}static take(t){return i(b,I).take(t)}static permute(t){return i(b,I).permute(t)}static permutation(t){return i(b,I).permutation(t)}static permutationsOf(t){return i(b,I).permutationsOf(t)}static derange(t){return i(b,I).derange(t)}static derangement(t){return i(b,I).derangement(t)}static derangementsOf(t){return i(b,I).derangementsOf(t)}};I=new WeakMap,y(b,I,new it(Math.random)),W(b,"Seedable",Te),W(b,"SFC32",xr),W(b,"JSF32B",vr),W(b,"SplitMix32",pr),W(b,"Mulberry32",Te),W(b,"GJRand32",br);let be=b;const jt=2**16;function Qe(a){return(a+1)/2}function fe(a,{freq:t=1,set:e}={}){return"ImageData"in globalThis&&a instanceof ImageData?{width:a.width,height:a.height,freq:t,typedArray:a.data,setCell:e??(({x:r,y:s,v:n})=>{const o=(r+s*a.width)*4;a.data[o]=a.data[o+1]=a.data[o+2]=n,a.data[o+3]=255})}:Array.isArray(a)?{width:a[0].length,height:a.length,freq:t,setCell:e??(({x:r,y:s,v:n})=>{a[s][r]=n})}:{width:a.width,height:a.data.length/a.width/a.stride,freq:t,typedArray:a.data,setCell:e??(({x:r,y:s,v:n})=>{const o=(r+s*a.width)*a.stride;a.data[o]=a.data[o+1]=a.data[o+2]=n,a.data[o+3]=255})}}class Y{constructor(t,e,r){W(this,"x");W(this,"y");W(this,"z");this.x=t,this.y=e,this.z=r}dot2(t,e){return this.x*t+this.y*e}dot3(t,e,r){return this.x*t+this.y*e+this.z*r}}const se=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],Ke=[new Y(1,1,0),new Y(-1,1,0),new Y(1,-1,0),new Y(-1,-1,0),new Y(1,0,1),new Y(-1,0,1),new Y(1,0,-1),new Y(-1,0,-1),new Y(0,1,1),new Y(0,-1,1),new Y(0,1,-1),new Y(0,-1,-1)];var M,O,ut;const Ie=class Ie{constructor(t=new it){y(this,M,void 0);y(this,O,void 0);y(this,ut,Ie.quintic);u(this,M,new Array(512)),u(this,O,new Array(512)),this.seed(t.float())}static linear(t){return t}static cubic(t){return(3-t*2)*t*t}static quintic(t){return t*t*t*(t*(t*6-15)+10)}ease(t){return u(this,ut,t),this}seed(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(let e=0;e<256;e++){let r;e&1?r=se[e]^t&255:r=se[e]^t>>8&255,i(this,M)[e]=i(this,M)[e+256]=r,i(this,O)[e]=i(this,O)[e+256]=Ke[r%12]}return this}xy(t,e){let r=Math.floor(t),s=Math.floor(e);const n=t-r,o=e-s;r=r&255,s=s&255;const l=i(this,O)[r+i(this,M)[s]].dot2(n,o),c=i(this,O)[r+i(this,M)[s+1]].dot2(n,o-1),h=i(this,O)[r+1+i(this,M)[s]].dot2(n-1,o),f=i(this,O)[r+1+i(this,M)[s+1]].dot2(n-1,o-1),m=i(this,ut).call(this,n);return R(R(l,h,m),R(c,f,m),i(this,ut).call(this,o))}xyz(t,e,r){let s=Math.floor(t),n=Math.floor(e),o=Math.floor(r);const l=t-s,c=e-n,h=r-o;s=s&255,n=n&255,o=o&255;const f=i(this,O)[s+i(this,M)[n+i(this,M)[o]]].dot3(l,c,h),m=i(this,O)[s+i(this,M)[n+i(this,M)[o+1]]].dot3(l,c,h-1),g=i(this,O)[s+i(this,M)[n+1+i(this,M)[o]]].dot3(l,c-1,h),d=i(this,O)[s+i(this,M)[n+1+i(this,M)[o+1]]].dot3(l,c-1,h-1),w=i(this,O)[s+1+i(this,M)[n+i(this,M)[o]]].dot3(l-1,c,h),$=i(this,O)[s+1+i(this,M)[n+i(this,M)[o+1]]].dot3(l-1,c,h-1),S=i(this,O)[s+1+i(this,M)[n+1+i(this,M)[o]]].dot3(l-1,c-1,h),N=i(this,O)[s+1+i(this,M)[n+1+i(this,M)[o+1]]].dot3(l-1,c-1,h-1),A=i(this,ut).call(this,l),q=i(this,ut).call(this,c),F=i(this,ut).call(this,h);return R(R(R(f,w,A),R(m,$,A),F),R(R(g,S,A),R(d,N,A),F),q)}fill(t,e){const{width:r,height:s,freq:n,setCell:o}=fe(t,e),l=Math.min(r,s);for(let c=0;c<r;c++)for(let h=0;h<s;h++){const f=c/(l/n),m=h/(l/n),g=(e==null?void 0:e.z)!==void 0?this.xyz(f,m,e==null?void 0:e.z):this.xy(f,m),d=R(0,255,Qe(g));o({x:c,y:h,z:(e==null?void 0:e.z)??0,v:d})}}};M=new WeakMap,O=new WeakMap,ut=new WeakMap;let Me=Ie;var P,X,ce,vt,he,J;const C=class C{constructor(t){y(this,P,void 0);y(this,X,void 0);u(this,P,new Array(512)),u(this,X,new Array(512)),this.seed((t||new it).float())}seed(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(let e=0;e<256;e++){let r;e&1?r=se[e]^t&255:r=se[e]^t>>8&255,i(this,P)[e]=i(this,P)[e+256]=r,i(this,X)[e]=i(this,X)[e+256]=Ke[r%12]}return this}xy(t,e){let r,s,n;const o=(t+e)*i(C,ce);let l=Math.floor(t+o),c=Math.floor(e+o);const h=(l+c)*i(C,vt),f=t-l+h,m=e-c+h;let g,d;f>m?(g=1,d=0):(g=0,d=1);const w=f-g+i(C,vt),$=m-d+i(C,vt),S=f-1+2*i(C,vt),N=m-1+2*i(C,vt);l&=255,c&=255;const A=i(this,X)[l+i(this,P)[c]],q=i(this,X)[l+g+i(this,P)[c+d]],F=i(this,X)[l+1+i(this,P)[c+1]];let T=.5-f*f-m*m;T<0?r=0:(T*=T,r=T*T*A.dot2(f,m));let Q=.5-w*w-$*$;Q<0?s=0:(Q*=Q,s=Q*Q*q.dot2(w,$));let K=.5-S*S-N*N;return K<0?n=0:(K*=K,n=K*K*F.dot2(S,N)),70*(r+s+n)}xyz(t,e,r){let s,n,o,l;const c=(t+e+r)*i(C,he);let h=Math.floor(t+c),f=Math.floor(e+c),m=Math.floor(r+c);const g=(h+f+m)*i(C,J),d=t-h+g,w=e-f+g,$=r-m+g;let S,N,A,q,F,T;d>=w?w>=$?(S=1,N=0,A=0,q=1,F=1,T=0):d>=$?(S=1,N=0,A=0,q=1,F=0,T=1):(S=0,N=0,A=1,q=1,F=0,T=1):w<$?(S=0,N=0,A=1,q=0,F=1,T=1):d<$?(S=0,N=1,A=0,q=0,F=1,T=1):(S=0,N=1,A=0,q=1,F=1,T=0);const Q=d-S+i(C,J),K=w-N+i(C,J),p=$-A+i(C,J),v=d-q+2*i(C,J),z=w-F+2*i(C,J),E=$-T+2*i(C,J),k=d-1+3*i(C,J),st=w-1+3*i(C,J),nt=$-1+3*i(C,J);h&=255,f&=255,m&=255;const me=i(this,X)[h+i(this,P)[f+i(this,P)[m]]],tr=i(this,X)[h+S+i(this,P)[f+N+i(this,P)[m+A]]],er=i(this,X)[h+q+i(this,P)[f+F+i(this,P)[m+T]]],rr=i(this,X)[h+1+i(this,P)[f+1+i(this,P)[m+1]]];let Ot=.6-d*d-w*w-$*$;Ot<0?s=0:(Ot*=Ot,s=Ot*Ot*me.dot3(d,w,$));let Rt=.6-Q*Q-K*K-p*p;Rt<0?n=0:(Rt*=Rt,n=Rt*Rt*tr.dot3(Q,K,p));let Pt=.6-v*v-z*z-E*E;Pt<0?o=0:(Pt*=Pt,o=Pt*Pt*er.dot3(v,z,E));let Lt=.6-k*k-st*st-nt*nt;return Lt<0?l=0:(Lt*=Lt,l=Lt*Lt*rr.dot3(k,st,nt)),32*(s+n+o+l)}fill(t,e){const{width:r,height:s,freq:n,setCell:o}=fe(t,e),l=Math.min(r,s);for(let c=0;c<r;c++)for(let h=0;h<s;h++){const f=c/(l/n),m=h/(l/n),g=(e==null?void 0:e.z)!==void 0?this.xyz(f,m,e==null?void 0:e.z):this.xy(f,m),d=R(0,255,Qe(g));o({x:c,y:h,z:(e==null?void 0:e.z)??0,v:d})}}};P=new WeakMap,X=new WeakMap,ce=new WeakMap,vt=new WeakMap,he=new WeakMap,J=new WeakMap,y(C,ce,.5*(Math.sqrt(3)-1)),y(C,vt,(3-Math.sqrt(3))/6),y(C,he,1/3),y(C,J,1/6);let Ee=C;var Nt,Ct,Xt,$e;class Mr{constructor(t,e=10){y(this,Xt);y(this,Nt,void 0);y(this,Ct,void 0);u(this,Ct,t||new it),u(this,Nt,tt(this,Xt,$e).call(this,e))}seed(t){return u(this,Nt,tt(this,Xt,$e).call(this,t)),this}xy(t,e){return this.xyz(t,e,0)}xyz(t,e,r){return i(this,Nt).nearestNeighbor([t,e,r]).distance}fill(t,e){const{width:r,height:s,freq:n,setCell:o}=fe(t,e);n!==i(this,Nt).size()-1&&this.seed(n);const l=Math.min(r,s);for(let c=0;c<r;c++)for(let h=0;h<s;h++){const f=c/l,m=h/l,g=(e==null?void 0:e.z)!==void 0?this.xyz(f,m,e==null?void 0:e.z):this.xy(f,m),d=R(0,255,g);o({x:c,y:h,z:(e==null?void 0:e.z)??0,v:d})}}}Nt=new WeakMap,Ct=new WeakMap,Xt=new WeakSet,$e=function(t){const e=ie.of(t,()=>[i(this,Ct).float({min:0,max:1}),i(this,Ct).float({min:0,max:1}),i(this,Ct).float({min:0,max:1})]);return new lr(e)};var Jt;class Er{constructor(t){y(this,Jt,void 0);u(this,Jt,t||new it)}seed(t){return this}xy(t,e){return i(this,Jt).float({min:-1,max:1})}xyz(t,e,r){return this.xy(t,e)}fill(t,e){const{width:r,height:s,freq:n,setCell:o,typedArray:l}=fe(t,e);if(l){const c=l.byteLength,h=Math.ceil(c/jt);if(h===1)crypto.getRandomValues(l);else for(let f=0;f<h;f++){const m=(f+1)*jt>c?c-f*jt:jt,g=new Uint8ClampedArray(m);crypto.getRandomValues(g),l.set(g,f*jt)}if(e!=null&&e.set)for(let f=0;f<r;f++)for(let m=0;m<s;m++){const g=(f+m*r)*4;e.set({x:f,y:m,z:0,v:l[g]})}}else throw new Error("NOT IMPLEMENTED")}}Jt=new WeakMap;const Z={Perlin:Me,Simplex:Ee,Worley:Mr,Color:Er},{math:ne,mtr:Ye,mtd:Ze,mtable:$r,msub:_e,msup:Jr,mrow:Wt,mo:Mt,mi:Ut,mn:ae}=et.tagsNS("http://www.w3.org/1998/Math/MathML");function Dt({matrix:a,det:t}){const e=a.data.map(s=>Ye({},...s.map(n=>Ze(ae(n))))),r=t?["|","|"]:["[","]"];return[Mt(r[0]),$r({frame:"solid",rowlines:"solid",align:"axis 3"},...e),Mt(r[1])]}function we({name:a,matrix:t}){const e=typeof a=="string"?Ut(a):_e(Ut(a.text),ae(a.sub));return t.data.map(r=>Ye({},...r.map(s=>Ze(ae(s))))),ne({display:"block"},e,Mt("="),Dt({matrix:t}))}function Ar(){const a=new bt([[43,0,1,99,420],[7,39,-66,-4,0],[7,39,-66,-4,0]]),t=new bt([[1],[1],[1],[1],[1]]);return ne({display:"block"},Wt({},Dt({matrix:a})),Mt("×"),Wt({},Dt({matrix:t})),Mt("="),Wt({},Dt({matrix:a.mul(t)})))}function zr(){const a=new bt([[-2,-1,2],[2,1,4],[-3,3,-1]]);return[ne({display:"block"},Ut("A"),Mt("="),Wt({},Dt({matrix:a,det:!1}))),ne({display:"block"},_e(Ut("det"),Ut("A")),Mt("="),Wt({},Dt({matrix:a,det:!0})),Mt("="),ae(a.determinant()))]}function Ir(){return[we({name:"S",matrix:new bt([[3,2],[-6,6]])}),we({name:{text:"I",sub:"3"},matrix:bt.identity(3)}),we({name:{text:"Z",sub:"3"},matrix:bt.zero(3)}),Ar(),zr()]}const{math:Sr,msup:Nr,mrow:Cr,mo:Tt,mi:qr,mn:Ae}=et.tagsNS("http://www.w3.org/1998/Math/MathML");function ke({complex:a}){const{real:t,imaginary:e}=a,r=[];return(t||!e)&&(t<0&&r.push(Tt("−")),r.push(Ae(Math.abs(t)))),e&&(e<0?r.push(Tt("−")):t&&r.push(Tt("+")),r.push(Ae(Math.abs(e)),qr("i"))),r}function Fr(){const a=new pe(5,-2);return Sr({display:"block"},Nr(Cr(Tt("("),ke({complex:a}),Tt(")")),Ae(2)),Tt("="),ke({complex:a.pow(2)}))}const{math:Dr,mrow:Tr,mo:oe,mi:ze,mn:te}=et.tagsNS("http://www.w3.org/1998/Math/MathML");function kr(...a){const[t,e]=a;let{from:r=0,to:s=0,step:n=1}=typeof t=="object"?t:{to:t};return r>s&&(n*=-1),[oe("["),te(r),ze(","),te(s),ze(":"),te(n),oe("]")]}function Oe(...a){return Dr({display:"block"},Tr(kr(...a),ze("="),oe("["),...ie.of(...a).map(t=>te(t)),oe("]")))}function Or(){return[Oe(5),Oe({from:13,to:9})]}const{div:Rr,pre:ge}=et.tags;function Pr(){const a=["alice","bob","carlos","dan","erin"],t=be.derangement(a);return Rr(ge(`const friends = ["alice", "bob", "carlos", "dan", "erin"];
const secretSantas = Random.derangement(friends);      `),ge(JSON.stringify(a)),ge(JSON.stringify(t)))}const{button:$t,input:Kt,label:Yt,div:Zt,canvas:Lr}=et.tags;function jr(a){const t=255-a,e=Math.abs(64-a)*4,r=Math.abs(128-a)*4;return{r:t,g:e,b:r}}function _t(a,t,e){a[t]=a[t+1]=a[t+2]=e,a[t+3]=255}function Ht(a,t,e){const{r,g:s,b:n}=jr(e);a[t]=s,a[t+1]=n,a[t+2]=r,a[t+3]=255}function Hr(){const r=Lr({width:400,height:400}),s=r.getContext("2d"),n=s.createImageData(400,400);let o=new Z.Perlin().seed(1),l=new Z.Perlin().seed(1);const c=et.state(!1),h=et.state(!1),f=et.state(.01),m=et.state(5);let g=0,d,w=$;function $(){o.fill(n,{freq:m.val,z:g,set:h.val?({x:p,y:v,v:z})=>{const E=(p+v*n.width)*4;Ht(n.data,E,z)}:void 0}),s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame($))}const S=s.createImageData(400,400);l.fill(S,{freq:400});function N(){o.fill(n,{freq:m.val,z:g,set:h.val?({x:p,y:v,v:z})=>{const E=(p+v*n.width)*4,k=z*.75+S.data[E]/4;Ht(n.data,E,k)}:({x:p,y:v,v:z})=>{const E=(p+v*n.width)*4,k=z*.75+S.data[E]/4;_t(n.data,E,k)}}),s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame(N))}function A(){o.fill(n,{freq:m.val,z:g,set:h.val?({x:p,y:v,z,v:E})=>{const k=R(0,64,(l.xyz(p/20,v/20,z)+1)/2),st=(p+v*n.width)*4,nt=E*.75+k;Ht(n.data,st,nt)}:({x:p,y:v,z,v:E})=>{const k=R(0,64,(l.xyz(p/20,v/20,z)+1)/2),st=(p+v*n.width)*4,nt=E*.75+k;_t(n.data,st,nt)}}),s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame(A))}function q(){const p=h.val?Ht:_t;for(let v=0;v<400;v++)for(let z=0;z<400;z++){const E=v/(400/m.val),k=z/(400/m.val),st=R(0,196,(o.xyz(E,k,g)+1)/2),nt=R(0,64,(o.xyz(E*10,k*10,g*10)+1)/2),me=(v+z*400)*4;p(n.data,me,st+nt)}s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame(q))}function F(){o.fill(n,{set:({x:p,y:v})=>{const z=(p+v*n.width)*4;n.data[z+3]=255}}),s.putImageData(n,0,0),c.val&&(d=requestAnimationFrame(F))}function T(){o.fill(n,{set:({x:p,y:v,v:z})=>{const E=(p+v*n.width)*4,k=z>127?255:0;n.data[E]=n.data[E+1]=n.data[E+2]=k,n.data[E+3]=255}}),s.putImageData(n,0,0),c.val&&(d=requestAnimationFrame(T))}let Q=1;function K(){const p=h.val?Ht:_t;o.fill(n,{z:g,freq:m.val,set:({x:v,y:z,v:E})=>{const k=(v+z*n.width)*4;p(n.data,k,E)}}),s.putImageData(n,0,0),g+=f.val*Q,(g>1||g<0)&&(g=g>1?1:0,Q*=-1),c.val&&(d=requestAnimationFrame(K))}return w(),Zt({style:"overflow-x: hidden;"},Zt({class:"iflexy"},Zt({class:"flexy"},$t({onclick:()=>{o=new Z.Perlin().seed(1),cancelAnimationFrame(d),w=$,w()}},"Perlin"),$t({onclick:()=>{o=new Z.Perlin().seed(1),l=new Z.Simplex().seed(1),cancelAnimationFrame(d),w=N,w()}},"Perlin + Static Simplex"),$t({onclick:()=>{o=new Z.Perlin().seed(1),l=new Z.Perlin().seed(1),cancelAnimationFrame(d),w=A,w()}},"Perlin Static Fractal"),$t({onclick:()=>{o=new Z.Perlin().seed(1),l=new Z.Perlin().seed(1),cancelAnimationFrame(d),w=q,w()}},"Perlin Fractal Dynamic"),$t({onclick:()=>{o=new Z.Color().seed(1),cancelAnimationFrame(d),w=F,w()}},"White"),$t({onclick:()=>{o=new Z.Color().seed(1),cancelAnimationFrame(d),w=T,w()}},"White (normalized)"),$t({onclick:()=>{o=new Z.Worley(null,m.val),cancelAnimationFrame(d),w=K,w()}},"Worley")),r,Zt({class:"flexy"},Yt("Run",Kt({type:"checkbox",defaultChecked:c.val,onchange:p=>{cancelAnimationFrame(d);const v=p.target.checked;c.val=v,w()}})),Yt("Speed",Kt({type:"range",defaultValue:f.val,min:.005,max:.1,step:.005,oninput:p=>{cancelAnimationFrame(d),f.val=p.target.valueAsNumber,w()}})),Yt("Freq",Kt({type:"range",min:1,max:100,defaultValue:5,oninput:p=>{cancelAnimationFrame(d),m.val=p.target.valueAsNumber,w()}})),Yt("Color",Kt({type:"checkbox",defaultChecked:h.val,onchange:p=>{cancelAnimationFrame(d);const v=p.target.checked;h.val=v,w()}})))))}const{div:Gr,main:Wr,details:Ur,summary:Vr}=et.tags;function Gt(a,t,...e){return Ur({open:t},Vr(a),Gr({class:"flexy"},...e))}function Br(){return Wr({},Gt("Matrix",!1,Ir()),Gt("Complex",!1,Fr()),Gt("Range",!1,Or()),Gt("Random",!1,Pr()),Gt("Noise",!0,Hr()))}et.add(document.body,Br());
