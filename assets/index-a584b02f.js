var nr=Object.defineProperty;var ar=(a,t,e)=>t in a?nr(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var W=(a,t,e)=>(ar(a,typeof t!="symbol"?t+"":t,e),e),ye=(a,t,e)=>{if(!t.has(a))throw TypeError("Cannot "+e)};var i=(a,t,e)=>(ye(a,t,"read from private field"),e?e.call(a):t.get(a)),y=(a,t,e)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,e)},u=(a,t,e,r)=>(ye(a,t,"write to private field"),r?r.call(a,e):t.set(a,e),e);var rt=(a,t,e)=>(ye(a,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();let Tt,se,at,It,Zt,ve=Object,ft=ve.getPrototypeOf,be=document,Pe={isConnected:1},Fe={},or=ft(Pe),Le=ft(ft),je=(a,t,e,r)=>(a??(setTimeout(e,r),new Set)).add(t),Ge=(a,t,e)=>{let r=at;at=t;try{return a(e)}catch(s){return console.error(s),e}finally{at=r}},ne=a=>a.filter(t=>{var e;return(e=t.t)==null?void 0:e.isConnected}),We=a=>Zt=je(Zt,a,()=>{for(let t of Zt)t.l=ne(t.l),t.o=ne(t.o);Zt=Tt},1e3),de={get val(){return at==null||at.add(this),this.i},get oldVal(){return at==null||at.add(this),this.u},set val(a){let t=this;if(a!==t.i){t.i=a;let e=[...t.o=ne(t.o)];for(let r of e)Ue(r.f,r.s,r.t),r.t=Tt;t.l.length?se=je(se,t,lr):t.u=a}}},Ve=a=>({__proto__:de,i:a,u:a,l:[],o:[]}),Ce=a=>ft(a??0)===de,Ot=(a,t)=>{let e=new Set,r={f:a},s=It;It=[];let n=Ge(a,e,t);n=(n??be).nodeType?n:new Text(n);for(let o of e)We(o),o.l.push(r);for(let o of It)o.t=n;return It=s,r.t=n},Ue=(a,t=Ve(),e)=>{let r=new Set,s={f:a,s:t};s.t=e??(It==null?void 0:It.push(s))??Pe,t.val=Ge(a,r);for(let n of r)We(n),n.o.push(s);return t},Be=(a,...t)=>{for(let e of t.flat(1/0)){let r=ft(e??0),s=r===de?Ot(()=>e.val):r===Le?Ot(e):e;s!=Tt&&a.append(s)}return a},Te=a=>new Proxy((t,...e)=>{var o;let[r,...s]=ft(e[0]??0)===or?e:[{},...e],n=a?be.createElementNS(a,t):be.createElement(t);for(let[l,c]of ve.entries(r)){let h=w=>w?ve.getOwnPropertyDescriptor(w,l)??h(ft(w)):Tt,f=t+","+l,m=Fe[f]??(Fe[f]=((o=h(ft(n)))==null?void 0:o.set)??0),g=m?m.bind(n):n.setAttribute.bind(n,l),d=ft(c??0);d===de?Ot(()=>(g(c.val),n)):d!==Le||l.startsWith("on")&&!c.h?g(c):Ot(()=>(g(c()),n))}return Be(n,...s)},{get:(t,e)=>t.bind(Tt,e)}),Je=(a,t)=>t?t!==a&&a.replaceWith(t):a.remove(),lr=()=>{let a=[...se].filter(t=>t.i!==t.u);se=Tt;for(let t of new Set(a.flatMap(e=>e.l=ne(e.l))))Je(t.t,Ot(t.f,t.t)),t.t=Tt;for(let t of a)t.u=t.i};const K={add:Be,_:a=>(a.h=1,a),tags:Te(),tagsNS:Te,state:Ve,val:a=>Ce(a)?a.val:a,oldVal:a=>Ce(a)?a.oldVal:a,derive:Ue,hydrate:(a,t)=>Je(a,Ot(t,a))};class cr{constructor(t){W(this,"parent");W(this,"point");W(this,"left");W(this,"right");this.point=t,this.parent=null,this.left=null,this.right=null}}var V,U,wt,ue,Xe,gt,kt;class hr{constructor(t,e={clone:!0}){y(this,ue);y(this,gt);y(this,V,void 0);y(this,U,void 0);y(this,wt,void 0);var r;u(this,V,t?e!=null&&e.clone?[...t]:t:[]),u(this,U,((r=t==null?void 0:t[0])==null?void 0:r.length)??0),u(this,wt,rt(this,gt,kt).call(this,i(this,V),0,null))}get dimensions(){return i(this,U)}get tree(){return i(this,wt)}[Symbol.iterator](){return i(this,V)[Symbol.iterator]()}insert(t){if(!i(this,V).length)u(this,U,t.length);else if(i(this,U)!==t.length)throw new TypeError(`Point [${t}] has ${t.length} dimensions, but should have ${i(this,U)}`);i(this,V).push(t),u(this,wt,rt(this,gt,kt).call(this,i(this,V),0,null))}remove(t){if(!i(this,V).length||t.length!==i(this,U))return;const e=this.nearestNeighbor(t);if(e.distance===0){const r=i(this,V).findIndex(s=>s===e.point);return i(this,V).splice(r,1),u(this,wt,rt(this,gt,kt).call(this,i(this,V),0,null)),e.point}}has(t){return t.length!==i(this,U)?!1:this.nearestNeighbor(t).distance===0}size(){return i(this,V).length}nearestNeighbor(t){function e(o,l){return l?o.reduce((c,h,f)=>c+(h-l[f])**2,0):1/0}function r(o,l){return o&&(!l||e(t,o.point)<=e(t,l.point))?o:l}const s=(o,l)=>{if(!o)return null;let c,h;t[l%i(this,U)]<=o.point[l%this.dimensions]?(c=o.left,h=o.right):(c=o.right,h=o.left);let f=s(c,l+1),m=r(f,o);const g=e(t,m==null?void 0:m.point),d=t[l%i(this,U)]-o.point[l%i(this,U)];return g>=d**2&&(f=s(h,l+1),m=r(f,m)),m},n=s(i(this,wt),0);return{point:(n==null?void 0:n.point)??null,distance:Math.sqrt(e(t,n==null?void 0:n.point))}}}V=new WeakMap,U=new WeakMap,wt=new WeakMap,ue=new WeakSet,Xe=function(t){const e=Math.floor(t.length/2);return[t[e],e]},gt=new WeakSet,kt=function(t,e,r){if(t.length===0)return null;t.sort((c,h)=>c[e]-h[e]);const[s,n]=rt(this,ue,Xe).call(this,t),o=(e+1)%i(this,U),l=new cr(s);return l.parent=r,l.left=rt(this,gt,kt).call(this,t.slice(0,n),o,l),l.right=rt(this,gt,kt).call(this,t.slice(n+1),o,l),l};function ur(a,...t){try{return new new Proxy(a,{construct(){return{}}})(...t??[]),!0}catch{return!1}}function ke(a,t,e){if(a>t)throw new RangeError("Minimum must be less than maximum");if(!(typeof e>"u")&&(a>e||e>t))throw new RangeError("Value must be between minimum and maximum")}function fr(...a){if(a.some(t=>!Number.isInteger(t)))throw new RangeError("Arguments must be integers")}function Qe(...a){if(a.some(t=>t<0||!Number.isInteger(t)))throw new RangeError("Arguments must be natural numbers")}function De(...a){if(a.some(t=>t<1||!Number.isInteger(t)))throw new RangeError("Arguments must be counting numbers")}var St,zt;const j=class j{constructor(t=0,e=0){y(this,St,void 0);y(this,zt,void 0);u(this,St,t),u(this,zt,e)}get real(){return i(this,St)}get imaginary(){return i(this,zt)}static from(t){return t instanceof j?t:new j(t.valueOf())}add(t){const e=j.from(t);return new j(this.real+e.real,this.imaginary+e.imaginary)}sub(t){const e=j.from(t);return new j(this.real-e.real,this.imaginary-e.imaginary)}mul(t){const e=j.from(t);return new j(this.real*e.real-this.imaginary*e.imaginary,this.real*e.imaginary+this.imaginary*e.real)}div(t){const e=j.from(t),r=e.conjugate(),s=this.mul(r),n=e.real**2+e.imaginary**2;return new j(s.real/n,s.imaginary/n)}pow(t){let e=this;for(let r=t.valueOf()-1;r>0;r--)e=e.mul(this);return e}abs(){return Math.sign(i(this,St))===Math.sign(i(this,zt))?this:new j(Math.abs(i(this,St)),Math.abs(i(this,zt)))}eq(...t){const e=j.from(...t);return this.real===e.real&&this.imaginary===e.imaginary}conjugate(){return new j(this.real,-1*this.imaginary)}valueOf(){return this.real}toFixed(t){return this.real.toFixed(t)}toExponential(t){return this.real.toExponential(t)}toPrecision(t){return this.real.toPrecision(t)}toString(t){return`${this.real===0&&this.imaginary!==0?"":this.real}${this.imaginary!==0?(this.imaginary===1?"+":this.imaginary.toLocaleString("en-US",{signDisplay:this.real===0?"auto":"always"}))+"i":""}`}toLocaleString(t,e){return this.toString()}[Symbol.toPrimitive](t){return t==="string"?this.toString():this.real}get[Symbol.toStringTag](){return"Complex"}};St=new WeakMap,zt=new WeakMap;let Me=j;const mr=256-1,dr=65536-1,dt=-1>>>0,wr=128-1,gr=-wr-1,yr=32768-1,xr=-yr-1,Ke=(dt+1)/2-1,pr=-Ke-1;var k;const x=class x{constructor(t){y(this,k,void 0);u(this,k,t)}get rows(){return i(this,k).length}get cols(){return i(this,k)[0].length}get size(){return this.rows*this.cols}get data(){return i(this,k)}static zero(t){if(t<=0)throw new RangeError(`Invalid matrix size [${t}x${t}]`);const e=new Array(t).fill(null).map(()=>new Array(t).fill(0));return new x(e)}static identity(t){if(t<=0)throw new RangeError(`Invalid matrix size [${t}x${t}]`);const e=x.zero(t);for(let r=0;r<t;r++)e.data[r][r]=1;return e}static withSize(t,e,r=0){if(t<=0||e<=0)throw new RangeError(`Invalid size [${t} x ${e}]`);const s=new Array(t).fill(null).map(()=>new Array(e).fill(r));return new x(s)}static fromDiagonal(t){const e=t.length;if(e<=0)throw new RangeError(`Invalid size [${e} x ${e}]`);const r=x.zero(e);for(let s=0;s<e;s++)i(r,k)[s][s]=t[s];return r}static fromMTX(t,e={}){const[r,...s]=t.split(/\n/),[n,o,l,c,h]=r.split(/\s+/).map(w=>w.toLowerCase());if(n!=="%%matrixmarket")throw new Error(`Unrecognized header '${n}'`);if(o!=="matrix")throw new Error(`Unrecognized object '${o}'`);if(!["coordinate","array"].includes(l))throw new Error(`Unrecognized format '${l}'`);if(l==="array"&&c==="pattern")throw new Error("Format 'array' is incompatible with symmetry type 'pattern'");if(e.format&&l!==e.format)throw new Error(`Specified format '${e.format}' does not match data format '${l}'`);if(!["real","complex","integer","pattern"].includes(c))throw new Error(`Unrecognized field type '${c}'`);if(h==="hermitian"&&c!=="complex"||c==="pattern"&&!["general","symmetric"].includes(h))throw new Error(`Symmetry type '${h}' is incompatible with field type '${c}'`);if(e.field&&c!==e.field)throw new Error(`Specified field type '${e.field}' does not match data field type '${c}'`);if(!["general","symmetric","skew-symmetric","hermitian"].includes(h))throw new Error(`Unrecognized symmetry type '${h}'`);if(h!=="general"||e.symmetry&&h!==e.symmetry)throw new Error("Type");for(;s[0].startsWith("%");)s.shift();const[f,m,g]=s.shift().split(/\s/).map(w=>parseInt(w));if(f!==m&&h!=="general")throw new Error(`Symmetry type '${h}' is unsupported for non-square matrices`);const d=x.withSize(f,m);for(let w=0,$=0;w<s.length;w++){const z=s[w];if(z.startsWith("%")||!z.trim())continue;let[N,A,C,T]=z.split(/\s+/).map(Number);if(l==="array"&&(C=N,T=A,[N,A]=[$%f+1,Math.floor($/f)+1],$++),!Number.isInteger(N)||!Number.isInteger(A))throw new Error(`Bad matrix coordinate ${N},${A}
${z}`);if(Number.isNaN(C))throw new Error(`Bad value '${C}`);if(Number.isNaN(T))throw new Error(`Bad value ${T}`);let D=C;switch(c){case"integer":{if(!Number.isInteger(C))throw new Error(`Non-integer value '${C}'`);break}case"complex":throw Number.isNaN(T)?new Error(`Invalid imaginary component '${T}'`):new Error("TODO");case"pattern":throw new Error("TODO")}i(d,k)[N-1][A-1]=D}return d}static isMatrixLike(t,...e){var n;if(t instanceof x)return!e.length||t.rows===e[0]&&t.cols===e[1];const[r,s]=e;return Array.isArray(t)&&Array.isArray(t[0])&&typeof((n=t[0][0])==null?void 0:n.valueOf())=="number"&&(!r&&!s||t.length===r&&t[0].length===s)}isSquare(){return this.rows===this.cols}isOrthogonal(){return this.isSquare()?this.transpose().mul(this).eq(x.identity(this.cols)):!1}at(t,e){var r;return(r=i(this,k).at(t))==null?void 0:r.at(e)}row(t){return this.data.at(t)}col(t){if(!(t>=this.cols))return this.data.map(e=>e.at(t))}clone(){const t=i(this,k).map(e=>[...e]);return new x(t)}submatrix({removeRows:t,removeCols:e,xywh:r}){if(r){const[s,n,o,l]=r,c=i(this,k).slice(n,l&&l+n).map(h=>h.slice(s,o&&o+s));return new x(c)}else{const s=i(this,k).reduce((n,o,l)=>{if(!t.includes(l)){const c=o.reduce((h,f,m)=>(e.includes(m)||h.push(f),h),[]);n.push(c)}return n},[]);return new x(s)}}trace(){if(!this.isSquare())throw new Error(`Cannot find trace of non-square matrix [${this.rows}x${this.cols}]`);let t=0;for(let e=0;e<this.rows;e++)t+=this.data[e][e];return t}determinant(){if(!this.isSquare())throw new Error(`Cannot find determinant of non-square matrix [${this.rows}x${this.cols}]`);if(this.size===1)return this.at(0,0);if(this.rows===2&&this.cols===2)return this.at(0,0)*this.at(1,1)-this.at(1,0)*this.at(0,1);if(this.rows===3&&this.cols===3)return this.at(0,0)*this.at(1,1)*this.at(2,2)+this.at(0,1)*this.at(1,2)*this.at(2,0)+this.at(0,2)*this.at(1,0)*this.at(2,1)-this.at(0,2)*this.at(1,1)*this.at(2,0)-this.at(0,1)*this.at(1,0)*this.at(2,2)-this.at(0,0)*this.at(1,2)*this.at(2,1);let t=0;for(let e=0;e<this.rows;e++){const r=this.submatrix({removeRows:[0],removeCols:[e]}),s=(-1)**(e%2),n=r.determinant();if(n===void 0)throw new Error("Failed to find subdeterminant");t+=this.at(0,e)*s*n}return t}augment(t){const e=t instanceof x?t:x.isMatrixLike(t)?new x(t):null;if(!e)throw new Error("Argument is not matrix-like.");if(e.rows!==this.rows)throw new Error(`Cannot augment matrix [${this.rows}x${this.cols}] by [${e.rows}x${e.cols}]`);const r=i(this,k).map((s,n)=>s.concat(e.row(n)));return new x(r)}inverse(t=5){if(!this.isSquare())throw new Error(`Cannot invert non-square matrix [${this.rows}x${this.cols}]`);if(!this.determinant())throw new Error("Cannot invert singular matrix");const e=this.augment(x.identity(this.rows)).data;e.forEach((s,n)=>{const o=s[n];o!==0&&e.forEach((l,c)=>{if(c===n||l[n]===0)return;const h=-1*(l[n]/o);e[c]=l.map((f,m)=>f+h*s[m])})}),e.forEach((s,n)=>{if(s[n]===1)return;const o=s[n]===0?1:1/s[n];e[n]=s.map(l=>l*o)});const r=new x(e).submatrix({xywh:[this.cols,0,this.cols,this.rows]});if(this.mul(r).eq(x.identity(this.rows),t))return r}transpose(){const t=x.withSize(this.cols,this.rows);for(let e=0;e<this.cols;e++)for(let r=0;r<this.rows;r++)i(t,k)[e][r]=i(this,k)[r][e];return t}vectorize(){return i(this,k).flat()}add(t){if(t instanceof x){if(this.cols!==t.cols||this.rows!==t.rows)throw new RangeError(`Cannot add receiver [${this.rows}x${this.cols}] to argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)+t.at(r,s);return new x(e)}else if(x.isMatrixLike(t)){if(this.rows!==t.length||this.cols!==t[0].length)throw new RangeError(`Cannot add receiver [${this.rows}x${this.cols}] to argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(this.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)+t[r][s];return new x(e)}else throw new TypeError(`Invalid argument ${t}`)}sub(t){if(t instanceof x){if(this.cols!==t.cols||this.rows!==t.rows)throw new RangeError(`Cannot subtract from receiver [${this.rows}x${this.cols}] argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)-t.at(r,s);return new x(e)}else if(x.isMatrixLike(t)){if(this.rows!==t.length||this.cols!==t[0].length)throw new RangeError(`Cannot subtract from receiver [${this.rows}x${this.cols}] argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(this.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<this.cols;s++)e[r][s]=this.at(r,s)-t[r][s];return new x(e)}else throw new TypeError(`Invalid argument ${t}`)}mul(t){if(t instanceof x){if(this.cols!==t.rows)throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let s=0;s<t.cols;s++)e[r][s]=i(this,k)[r].reduce((n,o,l)=>{const c=o*t.at(l,s);return n+c},0);return new x(e)}else if(x.isMatrixLike(t)){if(this.cols!==t.length||t[0].length<=0)throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t[0].length));for(let r=0;r<this.rows;r++)for(let s=0;s<t[0].length;s++)e[r][s]=i(this,k)[r].reduce((n,o,l)=>{const c=o*t[l][s];return n+c},0);return new x(e)}else{if(Array.isArray(t))throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.length}x?]`);return new x(i(this,k).map(e=>e.map(r=>r*t)))}}pow(t){if(t<0)throw new RangeError("Negative exponentiation is not permitted. If matrix is invertible, first invert then use positive exponentiation.");if(!this.isSquare())throw new Error("Exponentiation is only defined for square matricies");if(t===0)return x.identity(this.rows);{let e=this;for(let r=t-1;r>0;r--)e=e.mul(this);return e}}eq(t,e=5){function r(s,n){return e?Math.abs(s-n)<1/10**e:s===n}return t instanceof x?x.isMatrixLike(t.data,this.rows,this.cols)?t.data.every((s,n)=>s.every((o,l)=>r(o,this.at(n,l)))):!1:x.isMatrixLike(t,this.rows,this.cols)?t.every((s,n)=>s.every((o,l)=>r(o,this.at(n,l)))):!1}dot(t){if(this.cols!==1||!x.isMatrixLike(t))throw new Error("Cannot compute dot product of non column-vector matrices.");return this.transpose().mul(t).at(0,0)}[Symbol.iterator](){return i(this,k)[Symbol.iterator]()}};k=new WeakMap;let Mt=x;var Qt,Ee;const Xt=class Xt{constructor(...t){throw new Error("Range contains static methods only and is not meant to be constructed")}static of(t,e){var c;const{from:r,to:s,step:n,produce:o}=rt(c=Xt,Qt,Ee).call(c,t,e),l=[];for(let h=r;r<s?h<=s:h>=s;h+=n)l.push(o(h));return l}static*lazy(t,e){var l;const{from:r,to:s,step:n,produce:o}=rt(l=Xt,Qt,Ee).call(l,t,e);for(let c=r;r<s?c<=s:c>=s;c+=n)yield o(c)}};Qt=new WeakSet,Ee=function(t,e){let{from:r=0,to:s=0,step:n=1}=typeof t=="object"?t:{to:t-Math.sign(t)};if(r===s)throw new Error("Range must be nonzero in size");if(n<=0)throw new Error("Step size must be positive, as its sign is inferred from the range");r>s&&(n*=-1);const o=e?ur(e,r)?l=>new e(l):l=>e(l):l=>l;return{from:r,to:s,step:n,produce:o}},y(Xt,Qt);let ae=Xt;function O(a,t,e){return a+(t-a)*e}function $t(a,t,e){if(0>e||e>1)throw new RangeError("Value must be between 0 and 1 inclusive");return O(a,t,e)}function qe(a){if(Qe(a),a<=2)return a;let t=a,e=a;for(;e>1;)e--,t=t*e;return t}var P;class Ht{constructor(t=Math.random){y(this,P,void 0);u(this,P,t)}bool(){return i(this,P).call(this)>=.5}natural(t=dt-1){return Qe(t),Math.floor($t(0,t+1,i(this,P).call(this)))}counting(t=dt-1){return De(t),Math.floor($t(1,t+1,i(this,P).call(this)))}u8(){return Math.floor($t(0,mr+1,i(this,P).call(this)))}u16(){return Math.floor($t(0,dr+1,i(this,P).call(this)))}u32(){return Math.floor($t(0,dt+1,i(this,P).call(this)))}i8(){return this.u8()+gr}i16(){return this.u16()+xr}i32(){return this.u32()+pr}integer({min:t=0,max:e=dt}={max:dt}){return fr(t,e),ke(t,e),Math.floor($t(t,e+1,i(this,P).call(this)))}float({min:t,max:e}={}){if(t===void 0&&e===void 0||t===0&&e===1)return i(this,P).call(this);const r=t??0,s=e??Ke;return ke(r,s),$t(r,s,i(this,P).call(this))}dice(t){return this.integer({min:1,max:t})}unitVector(t=2){De(t);const e=i(this,P).call(this)*2*Math.PI;if(t===1)return[1];if(t===2)return[Math.cos(e),Math.sin(e)];if(t===3){const n=Math.acos(1-2*i(this,P).call(this));return[Math.cos(e)*Math.sin(n),Math.sin(e)*Math.sin(n),Math.cos(n)]}const r=Array(t).fill(null).map(()=>this.float({min:-1,max:1})),s=Math.sqrt(r.reduce((n,o)=>n+o**2,0));return r.map(n=>n/s)}sample(t){const e=t instanceof Set?[...t]:t;if(e.length===0)return;const r=this.natural(e.length-1);return e[r]}take(t){const e=t instanceof Set?[...t]:t;if(e.length===0)return;const r=this.natural(e.length-1),s=e[r];return t instanceof Set?t.delete(s):t.splice(r,1),s}permute(t){for(let e=0;e<t.length-1;e++){const r=e+this.integer({max:t.length-e-1}),s=t[e];t[e]=t[r],t[r]=s}}permutation(t){const e=[...t];for(let r=0;r<=t.length-1;r++){const s=r+this.integer({max:t.length-r-1}),n=e[r];e[r]=e[s],e[s]=n}return e}permutationsOf(t){let e=t instanceof Set?t.size:Array.isArray(t)?t.length:t;return e===0?1:qe(e)}derange(t){const e=new Array(t.length).fill(!1);let r=t.length,s=r;for(;s>=2;){if(!e[r-1]){let n=0;do n=this.integer({min:1,max:r-1});while(e[n-1]);const o=t[n-1];t[n-1]=t[r-1],t[r-1]=o,i(this,P).call(this)<(s-1)*this.derangementsOf(s-2)/this.derangementsOf(s)&&(e[n-1]=!0,s--),s--}r--}}derangement(t){const e=[...t];return this.derange(e),e}derangementsOf(t){let e=t instanceof Set?t.size:Array.isArray(t)?t.length:t;return Math.floor((qe(e)+1)/Math.E)}}P=new WeakMap;var it;class Re extends Ht{constructor(e){super(()=>{u(this,it,i(this,it)|0),u(this,it,i(this,it)+1831565813|0);let r=Math.imul(i(this,it)^i(this,it)>>>15,1|i(this,it));return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296});y(this,it,void 0);u(this,it,e)}}it=new WeakMap;var Nt,ot,et,yt;class vr extends Ht{constructor(e,r,s,n){super(()=>{u(this,Nt,i(this,Nt)|0),u(this,ot,i(this,ot)|0),u(this,et,i(this,et)|0),u(this,yt,i(this,yt)|0);const o=(i(this,Nt)+i(this,ot)|0)+i(this,yt)|0;return u(this,yt,i(this,yt)+1|0),u(this,Nt,i(this,ot)^i(this,ot)>>>9),u(this,ot,i(this,et)+(i(this,et)<<3)|0),u(this,et,i(this,et)<<21|i(this,et)>>>11),u(this,et,i(this,et)+o|0),(o>>>0)/4294967296});y(this,Nt,void 0);y(this,ot,void 0);y(this,et,void 0);y(this,yt,void 0);u(this,Nt,e),u(this,ot,r),u(this,et,s),u(this,yt,n)}}Nt=new WeakMap,ot=new WeakMap,et=new WeakMap,yt=new WeakMap;var lt;class br extends Ht{constructor(e){super(()=>{u(this,lt,i(this,lt)|0),u(this,lt,i(this,lt)+2654435769|0);let r=i(this,lt)^i(this,lt)>>>16;return r=Math.imul(r,569420461),r=r^r>>>15,r=Math.imul(r,1935289751),((r=r^r>>>15)>>>0)/4294967296});y(this,lt,void 0);u(this,lt,e)}}lt=new WeakMap;var xt,ct,pt,ht;class Mr extends Ht{constructor(e,r,s,n){super(()=>{u(this,xt,i(this,xt)|0),u(this,ct,i(this,ct)|0),u(this,pt,i(this,pt)|0),u(this,ht,i(this,ht)|0);let o=i(this,xt)-(i(this,ct)<<27|i(this,ct)>>>5)|0;return u(this,xt,i(this,ct)^(i(this,pt)<<17|s>>>15)),u(this,ct,i(this,pt)+i(this,ht)|0),u(this,pt,i(this,ht)+o|0),u(this,ht,i(this,xt)+o|0),(i(this,ht)>>>0)/4294967296});y(this,xt,void 0);y(this,ct,void 0);y(this,pt,void 0);y(this,ht,void 0);u(this,xt,e),u(this,ct,r),u(this,pt,s),u(this,ht,n)}}xt=new WeakMap,ct=new WeakMap,pt=new WeakMap,ht=new WeakMap;var G,B,L,vt;class Er extends Ht{constructor(e,r,s,n){super(()=>(u(this,G,i(this,G)|0),u(this,B,i(this,B)|0),u(this,L,i(this,L)|0),u(this,vt,i(this,vt)|0),u(this,G,i(this,G)<<16|i(this,G)>>>16),u(this,B,i(this,B)+i(this,L)|0),u(this,G,i(this,G)+i(this,B)|0),u(this,L,i(this,L)^i(this,B)),u(this,L,i(this,L)<<11|i(this,L)>>>21),u(this,B,i(this,B)^i(this,G)),u(this,G,i(this,G)+i(this,L)|0),u(this,B,i(this,L)<<19|i(this,L)>>>13),u(this,L,i(this,L)+i(this,G)|0),u(this,vt,i(this,vt)+38565|0),u(this,B,i(this,B)+i(this,vt)|0),(i(this,G)>>>0)/4294967296));y(this,G,void 0);y(this,B,void 0);y(this,L,void 0);y(this,vt,void 0);u(this,G,e),u(this,B,r),u(this,L,s),u(this,vt,n)}}G=new WeakMap,B=new WeakMap,L=new WeakMap,vt=new WeakMap;var S;const b=class b{constructor(...t){throw new Error("Random contains static methods only and is not meant to be constructed")}static bool(){return i(b,S).bool()}static natural(t=dt){return i(b,S).natural(t)}static counting(t=dt){return i(b,S).counting(t)}static u8(){return i(b,S).u8()}static u16(){return i(b,S).u16()}static u32(){return i(b,S).u32()}static i8(){return i(b,S).i8()}static i16(){return i(b,S).i16()}static i32(){return i(b,S).i32()}static integer(t){return i(b,S).integer(t)}static float(t){return i(b,S).float(t)}static dice(t){return i(b,S).dice(t)}static unitVector(t=2){return i(b,S).unitVector(t)}static sample(t){return i(b,S).sample(t)}static take(t){return i(b,S).take(t)}static permute(t){return i(b,S).permute(t)}static permutation(t){return i(b,S).permutation(t)}static permutationsOf(t){return i(b,S).permutationsOf(t)}static derange(t){return i(b,S).derange(t)}static derangement(t){return i(b,S).derangement(t)}static derangementsOf(t){return i(b,S).derangementsOf(t)}};S=new WeakMap,y(b,S,new Ht(Math.random)),W(b,"Seedable",Re),W(b,"SFC32",vr),W(b,"JSF32B",Mr),W(b,"SplitMix32",br),W(b,"Mulberry32",Re),W(b,"GJRand32",Er);let Q=b;const Wt=2**16;function Ye(a){return(a+1)/2}function we(a,{freq:t=1,set:e}={}){return"ImageData"in globalThis&&a instanceof ImageData?{width:a.width,height:a.height,freq:t,typedArray:a.data,setCell:e??(({x:r,y:s,v:n})=>{const o=(r+s*a.width)*4;a.data[o]=a.data[o+1]=a.data[o+2]=n,a.data[o+3]=255})}:Array.isArray(a)?{width:a[0].length,height:a.length,freq:t,setCell:e??(({x:r,y:s,v:n})=>{a[s][r]=n})}:{width:a.width,height:a.data.length/a.width/a.stride,freq:t,typedArray:a.data,setCell:e??(({x:r,y:s,v:n})=>{const o=(r+s*a.width)*a.stride;a.data[o]=a.data[o+1]=a.data[o+2]=n,a.data[o+3]=255})}}class _{constructor(t,e,r){W(this,"x");W(this,"y");W(this,"z");this.x=t,this.y=e,this.z=r}dot2(t,e){return this.x*t+this.y*e}dot3(t,e,r){return this.x*t+this.y*e+this.z*r}}const oe=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],Ze=[new _(1,1,0),new _(-1,1,0),new _(1,-1,0),new _(-1,-1,0),new _(1,0,1),new _(-1,0,1),new _(1,0,-1),new _(-1,0,-1),new _(0,1,1),new _(0,-1,1),new _(0,1,-1),new _(0,-1,-1)];var M,R,ut;const Ne=class Ne{constructor(t=Q){y(this,M,void 0);y(this,R,void 0);y(this,ut,Ne.quintic);u(this,M,new Array(512)),u(this,R,new Array(512)),this.seed(t.float())}static linear(t){return t}static cubic(t){return(3-t*2)*t*t}static quintic(t){return t*t*t*(t*(t*6-15)+10)}ease(t){return u(this,ut,t),this}seed(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(let e=0;e<256;e++){let r;e&1?r=oe[e]^t&255:r=oe[e]^t>>8&255,i(this,M)[e]=i(this,M)[e+256]=r,i(this,R)[e]=i(this,R)[e+256]=Ze[r%12]}return this}xy(t,e){let r=Math.floor(t),s=Math.floor(e);const n=t-r,o=e-s;r=r&255,s=s&255;const l=i(this,R)[r+i(this,M)[s]].dot2(n,o),c=i(this,R)[r+i(this,M)[s+1]].dot2(n,o-1),h=i(this,R)[r+1+i(this,M)[s]].dot2(n-1,o),f=i(this,R)[r+1+i(this,M)[s+1]].dot2(n-1,o-1),m=i(this,ut).call(this,n);return O(O(l,h,m),O(c,f,m),i(this,ut).call(this,o))}xyz(t,e,r){let s=Math.floor(t),n=Math.floor(e),o=Math.floor(r);const l=t-s,c=e-n,h=r-o;s=s&255,n=n&255,o=o&255;const f=i(this,R)[s+i(this,M)[n+i(this,M)[o]]].dot3(l,c,h),m=i(this,R)[s+i(this,M)[n+i(this,M)[o+1]]].dot3(l,c,h-1),g=i(this,R)[s+i(this,M)[n+1+i(this,M)[o]]].dot3(l,c-1,h),d=i(this,R)[s+i(this,M)[n+1+i(this,M)[o+1]]].dot3(l,c-1,h-1),w=i(this,R)[s+1+i(this,M)[n+i(this,M)[o]]].dot3(l-1,c,h),$=i(this,R)[s+1+i(this,M)[n+i(this,M)[o+1]]].dot3(l-1,c,h-1),z=i(this,R)[s+1+i(this,M)[n+1+i(this,M)[o]]].dot3(l-1,c-1,h),N=i(this,R)[s+1+i(this,M)[n+1+i(this,M)[o+1]]].dot3(l-1,c-1,h-1),A=i(this,ut).call(this,l),C=i(this,ut).call(this,c),T=i(this,ut).call(this,h);return O(O(O(f,w,A),O(m,$,A),T),O(O(g,z,A),O(d,N,A),T),C)}fill(t,e){const{width:r,height:s,freq:n,setCell:o}=we(t,e),l=Math.min(r,s);for(let c=0;c<r;c++)for(let h=0;h<s;h++){const f=c/(l/n),m=h/(l/n),g=(e==null?void 0:e.z)!==void 0?this.xyz(f,m,e==null?void 0:e.z):this.xy(f,m),d=O(0,255,Ye(g));o({x:c,y:h,z:(e==null?void 0:e.z)??0,v:d})}}};M=new WeakMap,R=new WeakMap,ut=new WeakMap;let $e=Ne;var H,J,fe,bt,me,X;const F=class F{constructor(t){y(this,H,void 0);y(this,J,void 0);u(this,H,new Array(512)),u(this,J,new Array(512)),this.seed((t||Q).float())}seed(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(let e=0;e<256;e++){let r;e&1?r=oe[e]^t&255:r=oe[e]^t>>8&255,i(this,H)[e]=i(this,H)[e+256]=r,i(this,J)[e]=i(this,J)[e+256]=Ze[r%12]}return this}xy(t,e){let r,s,n;const o=(t+e)*i(F,fe);let l=Math.floor(t+o),c=Math.floor(e+o);const h=(l+c)*i(F,bt),f=t-l+h,m=e-c+h;let g,d;f>m?(g=1,d=0):(g=0,d=1);const w=f-g+i(F,bt),$=m-d+i(F,bt),z=f-1+2*i(F,bt),N=m-1+2*i(F,bt);l&=255,c&=255;const A=i(this,J)[l+i(this,H)[c]],C=i(this,J)[l+g+i(this,H)[c+d]],T=i(this,J)[l+1+i(this,H)[c+1]];let D=.5-f*f-m*m;D<0?r=0:(D*=D,r=D*D*A.dot2(f,m));let Y=.5-w*w-$*$;Y<0?s=0:(Y*=Y,s=Y*Y*C.dot2(w,$));let Z=.5-z*z-N*N;return Z<0?n=0:(Z*=Z,n=Z*Z*T.dot2(z,N)),70*(r+s+n)}xyz(t,e,r){let s,n,o,l;const c=(t+e+r)*i(F,me);let h=Math.floor(t+c),f=Math.floor(e+c),m=Math.floor(r+c);const g=(h+f+m)*i(F,X),d=t-h+g,w=e-f+g,$=r-m+g;let z,N,A,C,T,D;d>=w?w>=$?(z=1,N=0,A=0,C=1,T=1,D=0):d>=$?(z=1,N=0,A=0,C=1,T=0,D=1):(z=0,N=0,A=1,C=1,T=0,D=1):w<$?(z=0,N=0,A=1,C=0,T=1,D=1):d<$?(z=0,N=1,A=0,C=0,T=1,D=1):(z=0,N=1,A=0,C=1,T=1,D=0);const Y=d-z+i(F,X),Z=w-N+i(F,X),p=$-A+i(F,X),v=d-C+2*i(F,X),I=w-T+2*i(F,X),E=$-D+2*i(F,X),q=d-1+3*i(F,X),st=w-1+3*i(F,X),nt=$-1+3*i(F,X);h&=255,f&=255,m&=255;const ge=i(this,J)[h+i(this,H)[f+i(this,H)[m]]],rr=i(this,J)[h+z+i(this,H)[f+N+i(this,H)[m+A]]],ir=i(this,J)[h+C+i(this,H)[f+T+i(this,H)[m+D]]],sr=i(this,J)[h+1+i(this,H)[f+1+i(this,H)[m+1]]];let Pt=.6-d*d-w*w-$*$;Pt<0?s=0:(Pt*=Pt,s=Pt*Pt*ge.dot3(d,w,$));let Lt=.6-Y*Y-Z*Z-p*p;Lt<0?n=0:(Lt*=Lt,n=Lt*Lt*rr.dot3(Y,Z,p));let jt=.6-v*v-I*I-E*E;jt<0?o=0:(jt*=jt,o=jt*jt*ir.dot3(v,I,E));let Gt=.6-q*q-st*st-nt*nt;return Gt<0?l=0:(Gt*=Gt,l=Gt*Gt*sr.dot3(q,st,nt)),32*(s+n+o+l)}fill(t,e){const{width:r,height:s,freq:n,setCell:o}=we(t,e),l=Math.min(r,s);for(let c=0;c<r;c++)for(let h=0;h<s;h++){const f=c/(l/n),m=h/(l/n),g=(e==null?void 0:e.z)!==void 0?this.xyz(f,m,e==null?void 0:e.z):this.xy(f,m),d=O(0,255,Ye(g));o({x:c,y:h,z:(e==null?void 0:e.z)??0,v:d})}}};H=new WeakMap,J=new WeakMap,fe=new WeakMap,bt=new WeakMap,me=new WeakMap,X=new WeakMap,y(F,fe,.5*(Math.sqrt(3)-1)),y(F,bt,(3-Math.sqrt(3))/6),y(F,me,1/3),y(F,X,1/6);let Ae=F;var Ft,Ct,Kt,Ie;class $r{constructor(t,e=10){y(this,Kt);y(this,Ft,void 0);y(this,Ct,void 0);u(this,Ct,t||Q),u(this,Ft,rt(this,Kt,Ie).call(this,e))}seed(t){return u(this,Ft,rt(this,Kt,Ie).call(this,t)),this}xy(t,e){return this.xyz(t,e,0)}xyz(t,e,r){return i(this,Ft).nearestNeighbor([t,e,r]).distance}fill(t,e){const{width:r,height:s,freq:n,setCell:o}=we(t,e);n!==i(this,Ft).size()-1&&this.seed(n);const l=Math.min(r,s);for(let c=0;c<r;c++)for(let h=0;h<s;h++){const f=c/l,m=h/l,g=(e==null?void 0:e.z)!==void 0?this.xyz(f,m,e==null?void 0:e.z):this.xy(f,m),d=O(0,255,g);o({x:c,y:h,z:(e==null?void 0:e.z)??0,v:d})}}}Ft=new WeakMap,Ct=new WeakMap,Kt=new WeakSet,Ie=function(t){const e=ae.of(t,()=>[i(this,Ct).float(),i(this,Ct).float(),i(this,Ct).float()]);return new hr(e)};var Yt;class Ar{constructor(t){y(this,Yt,void 0);u(this,Yt,t||Q)}seed(t){return this}xy(t,e){return i(this,Yt).float({min:-1,max:1})}xyz(t,e,r){return this.xy(t,e)}fill(t,e){const{width:r,height:s,freq:n,setCell:o,typedArray:l}=we(t,e);if(l){const c=l.byteLength,h=Math.ceil(c/Wt);if(h===1)crypto.getRandomValues(l);else for(let f=0;f<h;f++){const m=(f+1)*Wt>c?c-f*Wt:Wt,g=new Uint8ClampedArray(m);crypto.getRandomValues(g),l.set(g,f*Wt)}if(e!=null&&e.set)for(let f=0;f<r;f++)for(let m=0;m<s;m++){const g=(f+m*r)*4;e.set({x:f,y:m,z:0,v:l[g]})}}else throw new Error("NOT IMPLEMENTED")}}Yt=new WeakMap;const tt={Perlin:$e,Simplex:Ae,Worley:$r,Color:Ar},{math:le,mtr:_e,mtd:tr,mtable:Ir,msub:er,msup:ti,mrow:Bt,mo:Et,mi:Jt,mn:ce}=K.tagsNS("http://www.w3.org/1998/Math/MathML");function qt({matrix:a,det:t}){const e=a.data.map(s=>_e({},...s.map(n=>tr(ce(n))))),r=t?["|","|"]:["[","]"];return[Et(r[0]),Ir({frame:"solid",rowlines:"solid",align:"axis 3"},...e),Et(r[1])]}function xe({name:a,matrix:t}){const e=typeof a=="string"?Jt(a):er(Jt(a.text),ce(a.sub));return t.data.map(r=>_e({},...r.map(s=>tr(ce(s))))),le({display:"block"},e,Et("="),qt({matrix:t}))}function Sr(){const a=new Mt([[43,0,1,99,420],[7,39,-66,-4,0],[7,39,-66,-4,0]]),t=new Mt([[1],[1],[1],[1],[1]]);return le({display:"block"},Bt({},qt({matrix:a})),Et("×"),Bt({},qt({matrix:t})),Et("="),Bt({},qt({matrix:a.mul(t)})))}function zr(){const a=new Mt([[-2,-1,2],[2,1,4],[-3,3,-1]]);return[le({display:"block"},Jt("A"),Et("="),Bt({},qt({matrix:a,det:!1}))),le({display:"block"},er(Jt("det"),Jt("A")),Et("="),Bt({},qt({matrix:a,det:!0})),Et("="),ce(a.determinant()))]}function Nr(){return[xe({name:"S",matrix:new Mt([[3,2],[-6,6]])}),xe({name:{text:"I",sub:"3"},matrix:Mt.identity(3)}),xe({name:{text:"Z",sub:"3"},matrix:Mt.zero(3)}),Sr(),zr()]}const{math:Fr,msup:Cr,mrow:Tr,mo:Rt,mi:kr,mn:Se}=K.tagsNS("http://www.w3.org/1998/Math/MathML");function Oe({complex:a}){const{real:t,imaginary:e}=a,r=[];return(t||!e)&&(t<0&&r.push(Rt("−")),r.push(Se(Math.abs(t)))),e&&(e<0?r.push(Rt("−")):t&&r.push(Rt("+")),r.push(Se(Math.abs(e)),kr("i"))),r}function Dr(){const a=new Me(5,-2);return Fr({display:"block"},Cr(Tr(Rt("("),Oe({complex:a}),Rt(")")),Se(2)),Rt("="),Oe({complex:a.pow(2)}))}const{math:qr,mrow:Rr,mo:he,mi:ze,mn:ie}=K.tagsNS("http://www.w3.org/1998/Math/MathML");function Or(...a){const[t,e]=a;let{from:r=0,to:s=0,step:n=1}=typeof t=="object"?t:{to:t};return r>s&&(n*=-1),[he("["),ie(r),ze(","),ie(s),ze(":"),ie(n),he("]")]}function He(...a){return qr({display:"block"},Rr(Or(...a),ze("="),he("["),...ae.of(...a).map(t=>ie(t)),he("]")))}function Hr(){return[He(5),He({from:13,to:9})]}const{div:Dt,button:mt,label:Pr,input:Lr,pre:pe,canvas:jr}=K.tags;function Gr(){return Dt(Wr(),Vr())}function Wr(){const e=jr({width:400,height:400}),r=e.getContext("2d");let s=new Q.Seedable(0);function n(){r.clearRect(0,0,400,400)}function o(){r.fillStyle="#FF0C7C40";for(let m=0;m<c.val;m++){const g=s.integer({max:16e4}),[d,w]=[g%400,Math.floor(g/400)];r.fillRect(d,w,1,1)}l.val&&(h=requestAnimationFrame(o))}const l=K.state(!1),c=K.state(100);let h,f=o;return Dt({class:"iflexy"},Dt({class:"flexy"},mt({onclick:()=>{n(),s=new Q.Mulberry32(0)}},"Mulberry32"),mt({onclick:()=>{n(),s=new Q.SplitMix32(0)}},"SplitMix32"),mt({onclick:()=>{n(),s=new Q.SFC32(0,1,2,3)}},"SFC32"),mt({onclick:()=>{n(),s=new Q.JSF32B(0,1,2,3)}},"JSF32B"),mt({onclick:()=>{n(),s=new Q.GJRand32(0,1,2,3)}},"GJRand32")),e,Dt({class:"flexy"},Dt({class:"iflex"},mt({onclick:()=>{l.val=!0,cancelAnimationFrame(h),f()}},"Start"),mt({onclick:()=>{l.val=!1,cancelAnimationFrame(h)}},"Stop"),mt({onclick:n},"Clear")),Pr("Speed",Lr({type:"range",defaultValue:c.val,min:0,max:1e3,step:1,oninput:m=>{c.val=m.target.valueAsNumber}}))))}function Vr(){const a=["alice","bob","carlos","dan","erin"],t=Q.derangement(a);return Dt(pe(`const friends = ${JSON.stringify(a)};
const secretSantas = Random.derangement(friends);    `),pe(JSON.stringify(a)),pe(JSON.stringify(t)))}const{button:At,input:_t,label:te,div:ee,canvas:Ur}=K.tags;function Br(a){const t=255-a,e=Math.abs(64-a)*4,r=Math.abs(128-a)*4;return{r:t,g:e,b:r}}function re(a,t,e){a[t]=a[t+1]=a[t+2]=e,a[t+3]=255}function Vt(a,t,e){const{r,g:s,b:n}=Br(e);a[t]=s,a[t+1]=n,a[t+2]=r,a[t+3]=255}function Jr(){const r=Ur({width:400,height:400}),s=r.getContext("2d"),n=s.createImageData(400,400);let o=new tt.Perlin().seed(1),l=new tt.Perlin().seed(1);const c=K.state(!1),h=K.state(!1),f=K.state(.01),m=K.state(5);let g=0,d,w=$;function $(){o.fill(n,{freq:m.val,z:g,set:h.val?({x:p,y:v,v:I})=>{const E=(p+v*n.width)*4;Vt(n.data,E,I)}:void 0}),s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame($))}const z=s.createImageData(400,400);l.fill(z,{freq:400});function N(){o.fill(n,{freq:m.val,z:g,set:h.val?({x:p,y:v,v:I})=>{const E=(p+v*n.width)*4,q=I*.75+z.data[E]/4;Vt(n.data,E,q)}:({x:p,y:v,v:I})=>{const E=(p+v*n.width)*4,q=I*.75+z.data[E]/4;re(n.data,E,q)}}),s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame(N))}function A(){o.fill(n,{freq:m.val,z:g,set:h.val?({x:p,y:v,z:I,v:E})=>{const q=O(0,64,(l.xyz(p/20,v/20,I)+1)/2),st=(p+v*n.width)*4,nt=E*.75+q;Vt(n.data,st,nt)}:({x:p,y:v,z:I,v:E})=>{const q=O(0,64,(l.xyz(p/20,v/20,I)+1)/2),st=(p+v*n.width)*4,nt=E*.75+q;re(n.data,st,nt)}}),s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame(A))}function C(){const p=h.val?Vt:re;for(let v=0;v<400;v++)for(let I=0;I<400;I++){const E=v/(400/m.val),q=I/(400/m.val),st=O(0,196,(o.xyz(E,q,g)+1)/2),nt=O(0,64,(o.xyz(E*10,q*10,g*10)+1)/2),ge=(v+I*400)*4;p(n.data,ge,st+nt)}s.putImageData(n,0,0),g+=f.val,c.val&&(d=requestAnimationFrame(C))}function T(){o.fill(n,{set:({x:p,y:v})=>{const I=(p+v*n.width)*4;n.data[I+3]=255}}),s.putImageData(n,0,0),c.val&&(d=requestAnimationFrame(T))}function D(){o.fill(n,{set:({x:p,y:v,v:I})=>{const E=(p+v*n.width)*4,q=I>127?255:0;n.data[E]=n.data[E+1]=n.data[E+2]=q,n.data[E+3]=255}}),s.putImageData(n,0,0),c.val&&(d=requestAnimationFrame(D))}let Y=1;function Z(){const p=h.val?Vt:re;o.fill(n,{z:g,freq:m.val,set:({x:v,y:I,v:E})=>{const q=(v+I*n.width)*4;p(n.data,q,E)}}),s.putImageData(n,0,0),g+=f.val*Y,(g>1||g<0)&&(g=g>1?1:0,Y*=-1),c.val&&(d=requestAnimationFrame(Z))}return w(),ee({style:"overflow-x: hidden;"},ee({class:"iflexy"},ee({class:"flexy"},At({onclick:()=>{o=new tt.Perlin().seed(1),cancelAnimationFrame(d),w=$,w()}},"Perlin"),At({onclick:()=>{o=new tt.Perlin().seed(1),l=new tt.Simplex().seed(1),cancelAnimationFrame(d),w=N,w()}},"Perlin + Static Simplex"),At({onclick:()=>{o=new tt.Perlin().seed(1),l=new tt.Perlin().seed(1),cancelAnimationFrame(d),w=A,w()}},"Perlin Static Fractal"),At({onclick:()=>{o=new tt.Perlin().seed(1),l=new tt.Perlin().seed(1),cancelAnimationFrame(d),w=C,w()}},"Perlin Fractal Dynamic"),At({onclick:()=>{o=new tt.Color().seed(1),cancelAnimationFrame(d),w=T,w()}},"White"),At({onclick:()=>{o=new tt.Color().seed(1),cancelAnimationFrame(d),w=D,w()}},"White (normalized)"),At({onclick:()=>{o=new tt.Worley(null,m.val),cancelAnimationFrame(d),w=Z,w()}},"Worley")),r,ee({class:"flexy"},te("Run",_t({type:"checkbox",defaultChecked:c.val,onchange:p=>{cancelAnimationFrame(d);const v=p.target.checked;c.val=v,w()}})),te("Speed",_t({type:"range",defaultValue:f.val,min:.005,max:.1,step:.005,oninput:p=>{cancelAnimationFrame(d),f.val=p.target.valueAsNumber,w()}})),te("Freq",_t({type:"range",min:1,max:100,defaultValue:5,oninput:p=>{cancelAnimationFrame(d),m.val=p.target.valueAsNumber,w()}})),te("Color",_t({type:"checkbox",defaultChecked:h.val,onchange:p=>{cancelAnimationFrame(d);const v=p.target.checked;h.val=v,w()}})))))}const{div:Xr,main:Qr,details:Kr,summary:Yr}=K.tags;function Ut(a,t,...e){return Kr({open:t},Yr(a),Xr({class:"flexy"},...e))}function Zr(){return Qr({},Ut("Matrix",!1,Nr()),Ut("Complex",!1,Dr()),Ut("Range",!1,Hr()),Ut("Random",!1,Gr()),Ut("Noise",!0,Jr()))}K.add(document.body,Zr());
