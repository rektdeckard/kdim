var $e=Object.defineProperty;var Me=(i,t,e)=>t in i?$e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var ht=(i,t,e)=>(Me(i,typeof t!="symbol"?t+"":t,e),e),Nt=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var a=(i,t,e)=>(Nt(i,t,"read from private field"),e?e.call(i):t.get(i)),C=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},R=(i,t,e,r)=>(Nt(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e);var Ct=(i,t,e)=>(Nt(i,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();let J,mt,P,Q,ut,jt=Object,H=jt.getPrototypeOf,kt=document,re={isConnected:1},Gt={},Ee=H(re),ne=H(H),ie=(i,t,e,r)=>(i??(setTimeout(e,r),new Set)).add(t),se=(i,t,e)=>{let r=P;P=t;try{return i(e)}catch(n){return console.error(n),e}finally{P=r}},dt=i=>i.filter(t=>{var e;return(e=t.t)==null?void 0:e.isConnected}),ae=i=>ut=ie(ut,i,()=>{for(let t of ut)t.l=dt(t.l),t.o=dt(t.o);ut=J},1e3),vt={get val(){return P==null||P.add(this),this.i},get oldVal(){return P==null||P.add(this),this.u},set val(i){let t=this;if(i!==t.i){t.i=i;let e=[...t.o=dt(t.o)];for(let r of e)le(r.f,r.s,r.t),r.t=J;t.l.length?mt=ie(mt,t,Ae):t.u=i}}},oe=i=>({__proto__:vt,i,u:i,l:[],o:[]}),Wt=i=>H(i??0)===vt,Y=(i,t)=>{let e=new Set,r={f:i},n=Q;Q=[];let s=se(i,e,t);s=(s??kt).nodeType?s:new Text(s);for(let o of e)ae(o),o.l.push(r);for(let o of Q)o.t=s;return Q=n,r.t=s},le=(i,t=oe(),e)=>{let r=new Set,n={f:i,s:t};n.t=e??(Q==null?void 0:Q.push(n))??re,t.val=se(i,r);for(let s of r)ae(s),s.o.push(n);return t},ce=(i,...t)=>{for(let e of t.flat(1/0)){let r=H(e??0),n=r===vt?Y(()=>e.val):r===ne?Y(e):e;n!=J&&i.append(n)}return i},Xt=i=>new Proxy((t,...e)=>{var o;let[r,...n]=H(e[0]??0)===Ee?e:[{},...e],s=i?kt.createElementNS(i,t):kt.createElement(t);for(let[l,c]of jt.entries(r)){let h=d=>d?jt.getOwnPropertyDescriptor(d,l)??h(H(d)):J,u=t+","+l,f=Gt[u]??(Gt[u]=((o=h(H(s)))==null?void 0:o.set)??0),w=f?f.bind(s):s.setAttribute.bind(s,l),x=H(c??0);x===vt?Y(()=>(w(c.val),s)):x!==ne||l.startsWith("on")&&!c.h?w(c):Y(()=>(w(c()),s))}return ce(s,...n)},{get:(t,e)=>t.bind(J,e)}),he=(i,t)=>t?t!==i&&i.replaceWith(t):i.remove(),Ae=()=>{let i=[...mt].filter(t=>t.i!==t.u);mt=J;for(let t of new Set(i.flatMap(e=>e.l=dt(e.l))))he(t.t,Y(t.f,t.t)),t.t=J;for(let t of i)t.u=t.i};const V={add:ce,_:i=>(i.h=1,i),tags:Xt(),tagsNS:Xt,state:oe,val:i=>Wt(i)?i.val:i,oldVal:i=>Wt(i)?i.oldVal:i,derive:le,hydrate:(i,t)=>he(i,Y(t,i))};function ze(i,...t){try{return new new Proxy(i,{construct(){return{}}})(...t??[]),!0}catch{return!1}}function Bt(i,t,e){if(i>t)throw new RangeError("Minimum must be less than maximum");if(!(typeof e>"u")&&(i>e||e>t))throw new RangeError("Value must be between minimum and maximum")}function Ie(...i){if(i.some(t=>!Number.isInteger(t)))throw new RangeError("Arguments must be integers")}function ue(...i){if(i.some(t=>t<0||!Number.isInteger(t)))throw new RangeError("Arguments must be natural numbers")}function Qt(...i){if(i.some(t=>t<1||!Number.isInteger(t)))throw new RangeError("Arguments must be counting numbers")}var ot,lt;const O=class O{constructor(t=0,e=0){C(this,ot,void 0);C(this,lt,void 0);R(this,ot,t),R(this,lt,e)}get real(){return a(this,ot)}get imaginary(){return a(this,lt)}static from(t){return t instanceof O?t:new O(t.valueOf())}add(t){const e=O.from(t);return new O(this.real+e.real,this.imaginary+e.imaginary)}sub(t){const e=O.from(t);return new O(this.real-e.real,this.imaginary-e.imaginary)}mul(t){const e=O.from(t);return new O(this.real*e.real-this.imaginary*e.imaginary,this.real*e.imaginary+this.imaginary*e.real)}div(t){const e=O.from(t),r=e.conjugate(),n=this.mul(r),s=e.real**2+e.imaginary**2;return new O(n.real/s,n.imaginary/s)}pow(t){let e=this;for(let r=t.valueOf()-1;r>0;r--)e=e.mul(this);return e}eq(...t){const e=O.from(...t);return this.real===e.real&&this.imaginary===e.imaginary}conjugate(){return new O(this.real,-1*this.imaginary)}valueOf(){return this.real}toFixed(t){return this.real.toFixed(t)}toExponential(t){return this.real.toExponential(t)}toPrecision(t){return this.real.toPrecision(t)}toString(t){return`${this.real===0&&this.imaginary!==0?"":this.real}${this.imaginary!==0?(this.imaginary===1?"+":this.imaginary.toLocaleString("en-US",{signDisplay:this.real===0?"auto":"always"}))+"i":""}`}toLocaleString(t,e){return this.toString()}[Symbol.toPrimitive](t){return t==="string"?this.toString():this.real}get[Symbol.toStringTag](){return"Complex"}};ot=new WeakMap,lt=new WeakMap;let Tt=O;const Se=256-1,Ne=65536-1,G=-1>>>0,Ce=128-1,qe=-Ce-1,Oe=32768-1,De=-Oe-1,je=(G+1)/2-1,ke=-je-1;var A;const m=class m{constructor(t){C(this,A,void 0);R(this,A,t)}get rows(){return a(this,A).length}get cols(){return a(this,A)[0].length}get size(){return this.rows*this.cols}get data(){return a(this,A)}static zero(t){if(t<=0)throw new RangeError(`Invalid matrix size [${t}x${t}]`);const e=new Array(t).fill(null).map(()=>new Array(t).fill(0));return new m(e)}static identity(t){if(t<=0)throw new RangeError(`Invalid matrix size [${t}x${t}]`);const e=m.zero(t);for(let r=0;r<t;r++)e.data[r][r]=1;return e}static withSize(t,e,r=0){if(t<=0||e<=0)throw new RangeError(`Invalid size [${t} x ${e}]`);const n=new Array(t).fill(null).map(()=>new Array(e).fill(r));return new m(n)}static fromDiagonal(t){const e=t.length;if(e<=0)throw new RangeError(`Invalid size [${e} x ${e}]`);const r=m.zero(e);for(let n=0;n<e;n++)a(r,A)[n][n]=t[n];return r}static fromMTX(t,e={}){const[r,...n]=t.split(/\n/),[s,o,l,c,h]=r.split(/\s+/).map(d=>d.toLowerCase());if(s!=="%%matrixmarket")throw new Error(`Unrecognized header '${s}'`);if(o!=="matrix")throw new Error(`Unrecognized object '${o}'`);if(!["coordinate","array"].includes(l))throw new Error(`Unrecognized format '${l}'`);if(l==="array"&&c==="pattern")throw new Error("Format 'array' is incompatible with symmetry type 'pattern'");if(e.format&&l!==e.format)throw new Error(`Specified format '${e.format}' does not match data format '${l}'`);if(!["real","complex","integer","pattern"].includes(c))throw new Error(`Unrecognized field type '${c}'`);if(h==="hermitian"&&c!=="complex"||c==="pattern"&&!["general","symmetric"].includes(h))throw new Error(`Symmetry type '${h}' is incompatible with field type '${c}'`);if(e.field&&c!==e.field)throw new Error(`Specified field type '${e.field}' does not match data field type '${c}'`);if(!["general","symmetric","skew-symmetric","hermitian"].includes(h))throw new Error(`Unrecognized symmetry type '${h}'`);if(h!=="general"||e.symmetry&&h!==e.symmetry)throw new Error("Type");for(;n[0].startsWith("%");)n.shift();const[u,f,w]=n.shift().split(/\s/).map(d=>parseInt(d));if(u!==f&&h!=="general")throw new Error(`Symmetry type '${h}' is unsupported for non-square matrices`);const x=m.withSize(u,f);for(let d=0,v=0;d<n.length;d++){const E=n[d];if(E.startsWith("%")||!E.trim())continue;let[g,y,$,p]=E.split(/\s+/).map(Number);if(l==="array"&&($=g,p=y,[g,y]=[v%u+1,Math.floor(v/u)+1],v++),!Number.isInteger(g)||!Number.isInteger(y))throw new Error(`Bad matrix coordinate ${g},${y}
${E}`);if(Number.isNaN($))throw new Error(`Bad value '${$}`);if(Number.isNaN(p))throw new Error(`Bad value ${p}`);let z=$;switch(c){case"integer":{if(!Number.isInteger($))throw new Error(`Non-integer value '${$}'`);break}case"complex":throw Number.isNaN(p)?new Error(`Invalid imaginary component '${p}'`):new Error("TODO");case"pattern":throw new Error("TODO")}a(x,A)[g-1][y-1]=z}return x}static isMatrixLike(t,...e){var s;if(t instanceof m)return!e.length||t.rows===e[0]&&t.cols===e[1];const[r,n]=e;return Array.isArray(t)&&Array.isArray(t[0])&&typeof((s=t[0][0])==null?void 0:s.valueOf())=="number"&&(!r&&!n||t.length===r&&t[0].length===n)}isSquare(){return this.rows===this.cols}isOrthogonal(){return this.isSquare()?this.transpose().mul(this).eq(m.identity(this.cols)):!1}at(t,e){var r;return(r=a(this,A).at(t))==null?void 0:r.at(e)}row(t){return this.data.at(t)}col(t){if(!(t>=this.cols))return this.data.map(e=>e.at(t))}clone(){const t=a(this,A).map(e=>[...e]);return new m(t)}submatrix({removeRows:t,removeCols:e,xywh:r}){if(r){const[n,s,o,l]=r,c=a(this,A).slice(s,l&&l+s).map(h=>h.slice(n,o&&o+n));return new m(c)}else{const n=a(this,A).reduce((s,o,l)=>{if(!t.includes(l)){const c=o.reduce((h,u,f)=>(e.includes(f)||h.push(u),h),[]);s.push(c)}return s},[]);return new m(n)}}trace(){if(!this.isSquare())throw new Error(`Cannot find trace of non-square matrix [${this.rows}x${this.cols}]`);let t=0;for(let e=0;e<this.rows;e++)t+=this.data[e][e];return t}determinant(){if(!this.isSquare())throw new Error(`Cannot find determinant of non-square matrix [${this.rows}x${this.cols}]`);if(this.size===1)return this.at(0,0);if(this.rows===2&&this.cols===2)return this.at(0,0)*this.at(1,1)-this.at(1,0)*this.at(0,1);if(this.rows===3&&this.cols===3)return this.at(0,0)*this.at(1,1)*this.at(2,2)+this.at(0,1)*this.at(1,2)*this.at(2,0)+this.at(0,2)*this.at(1,0)*this.at(2,1)-this.at(0,2)*this.at(1,1)*this.at(2,0)-this.at(0,1)*this.at(1,0)*this.at(2,2)-this.at(0,0)*this.at(1,2)*this.at(2,1);let t=0;for(let e=0;e<this.rows;e++){const r=this.submatrix({removeRows:[0],removeCols:[e]}),n=(-1)**(e%2),s=r.determinant();if(s===void 0)throw new Error("Failed to find subdeterminant");t+=this.at(0,e)*n*s}return t}augment(t){const e=t instanceof m?t:m.isMatrixLike(t)?new m(t):null;if(!e)throw new Error("Argument is not matrix-like.");if(e.rows!==this.rows)throw new Error(`Cannot augment matrix [${this.rows}x${this.cols}] by [${e.rows}x${e.cols}]`);const r=a(this,A).map((n,s)=>n.concat(e.row(s)));return new m(r)}inverse(t=5){if(!this.isSquare())throw new Error(`Cannot invert non-square matrix [${this.rows}x${this.cols}]`);if(!this.determinant())throw new Error("Cannot invert singular matrix");const e=this.augment(m.identity(this.rows)).data;e.forEach((n,s)=>{const o=n[s];o!==0&&e.forEach((l,c)=>{if(c===s||l[s]===0)return;const h=-1*(l[s]/o);e[c]=l.map((u,f)=>u+h*n[f])})}),e.forEach((n,s)=>{if(n[s]===1)return;const o=n[s]===0?1:1/n[s];e[s]=n.map(l=>l*o)});const r=new m(e).submatrix({xywh:[this.cols,0,this.cols,this.rows]});if(this.mul(r).eq(m.identity(this.rows),t))return r}transpose(){const t=m.withSize(this.cols,this.rows);for(let e=0;e<this.cols;e++)for(let r=0;r<this.rows;r++)a(t,A)[e][r]=a(this,A)[r][e];return t}vectorize(){return a(this,A).flat()}add(t){if(t instanceof m){if(this.cols!==t.cols||this.rows!==t.rows)throw new RangeError(`Cannot add receiver [${this.rows}x${this.cols}] to argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let n=0;n<this.cols;n++)e[r][n]=this.at(r,n)+t.at(r,n);return new m(e)}else if(m.isMatrixLike(t)){if(this.rows!==t.length||this.cols!==t[0].length)throw new RangeError(`Cannot add receiver [${this.rows}x${this.cols}] to argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(this.cols));for(let r=0;r<this.rows;r++)for(let n=0;n<this.cols;n++)e[r][n]=this.at(r,n)+t[r][n];return new m(e)}else throw new TypeError(`Invalid argument ${t}`)}sub(t){if(t instanceof m){if(this.cols!==t.cols||this.rows!==t.rows)throw new RangeError(`Cannot subtract from receiver [${this.rows}x${this.cols}] argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let n=0;n<this.cols;n++)e[r][n]=this.at(r,n)-t.at(r,n);return new m(e)}else if(m.isMatrixLike(t)){if(this.rows!==t.length||this.cols!==t[0].length)throw new RangeError(`Cannot subtract from receiver [${this.rows}x${this.cols}] argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(this.cols));for(let r=0;r<this.rows;r++)for(let n=0;n<this.cols;n++)e[r][n]=this.at(r,n)-t[r][n];return new m(e)}else throw new TypeError(`Invalid argument ${t}`)}mul(t){if(t instanceof m){if(this.cols!==t.rows)throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.rows}x${t.cols}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t.cols));for(let r=0;r<this.rows;r++)for(let n=0;n<t.cols;n++)e[r][n]=a(this,A)[r].reduce((s,o,l)=>{const c=o*t.at(l,n);return s+c},0);return new m(e)}else if(m.isMatrixLike(t)){if(this.cols!==t.length||t[0].length<=0)throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.length}x${t[0].length}]`);const e=new Array(this.rows).fill(null).map(()=>new Array(t[0].length));for(let r=0;r<this.rows;r++)for(let n=0;n<t[0].length;n++)e[r][n]=a(this,A)[r].reduce((s,o,l)=>{const c=o*t[l][n];return s+c},0);return new m(e)}else{if(Array.isArray(t))throw new RangeError(`Cannot multiply receiver [${this.rows}x${this.cols}] by argument [${t.length}x?]`);return new m(a(this,A).map(e=>e.map(r=>r*t)))}}pow(t){if(t<0)throw new RangeError("Negative exponentiation is not permitted. If matrix is invertible, first invert then use positive exponentiation.");if(!this.isSquare())throw new Error("Exponentiation is only defined for square matricies");if(t===0)return m.identity(this.rows);{let e=this;for(let r=t-1;r>0;r--)e=e.mul(this);return e}}eq(t,e=5){function r(n,s){return e?Math.abs(n-s)<1/10**e:n===s}return t instanceof m?m.isMatrixLike(t.data,this.rows,this.cols)?t.data.every((n,s)=>n.every((o,l)=>r(o,this.at(s,l)))):!1:m.isMatrixLike(t,this.rows,this.cols)?t.every((n,s)=>n.every((o,l)=>r(o,this.at(s,l)))):!1}dot(t){if(this.cols!==1||!m.isMatrixLike(t))throw new Error("Cannot compute dot product of non column-vector matrices.");return this.transpose().mul(t).at(0,0)}[Symbol.iterator](){return a(this,A)[Symbol.iterator]()}};A=new WeakMap;let X=m;function D(i,t,e){return i+(t-i)*e}function F(i,t,e){if(0>e||e>1)throw new RangeError("Value must be between 0 and 1 inclusive");return D(i,t,e)}function Jt(i){if(ue(i),i<=2)return i;let t=i,e=i;for(;e>1;)e--,t=t*e;return t}function fe(i){return(i+1)/2}function me(i,{freq:t=1,set:e}={}){return"ImageData"in globalThis&&i instanceof ImageData?{width:i.width,height:i.height,freq:t,typedArray:i.data,setCell:e??(({x:r,y:n,v:s})=>{const o=(r+n*i.width)*4;i.data[o]=i.data[o+1]=i.data[o+2]=s,i.data[o+3]=255})}:Array.isArray(i)?{width:i[0].length,height:i.length,freq:t,setCell:e??(({x:r,y:n,v:s})=>{i[n][r]=s})}:{width:i.width,height:i.data.length/i.width/i.stride,freq:t,typedArray:i.data,setCell:e??(({x:r,y:n,v:s})=>{const o=(r+n*i.width)*i.stride;i.data[o]=i.data[o+1]=i.data[o+2]=s,i.data[o+3]=255})}}class T{constructor(t,e,r){ht(this,"x");ht(this,"y");ht(this,"z");this.x=t,this.y=e,this.z=r}dot2(t,e){return this.x*t+this.y*e}dot3(t,e,r){return this.x*t+this.y*e+this.z*r}}const wt=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],de=[new T(1,1,0),new T(-1,1,0),new T(1,-1,0),new T(-1,-1,0),new T(1,0,1),new T(-1,0,1),new T(1,0,-1),new T(-1,0,-1),new T(0,1,1),new T(0,-1,1),new T(0,1,-1),new T(0,-1,-1)];var b,I,U;const Vt=class Vt{constructor(t=Math.random()){C(this,b,void 0);C(this,I,void 0);C(this,U,Vt.quintic);R(this,b,new Array(512)),R(this,I,new Array(512)),this.seed(t)}static linear(t){return t}static cubic(t){return(3-t*2)*t*t}static quintic(t){return t*t*t*(t*(t*6-15)+10)}ease(t){return R(this,U,t),this}seed(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(let e=0;e<256;e++){let r;e&1?r=wt[e]^t&255:r=wt[e]^t>>8&255,a(this,b)[e]=a(this,b)[e+256]=r,a(this,I)[e]=a(this,I)[e+256]=de[r%12]}return this}xy(t,e){let r=Math.floor(t),n=Math.floor(e);const s=t-r,o=e-n;r=r&255,n=n&255;const l=a(this,I)[r+a(this,b)[n]].dot2(s,o),c=a(this,I)[r+a(this,b)[n+1]].dot2(s,o-1),h=a(this,I)[r+1+a(this,b)[n]].dot2(s-1,o),u=a(this,I)[r+1+a(this,b)[n+1]].dot2(s-1,o-1),f=a(this,U).call(this,s);return D(D(l,h,f),D(c,u,f),a(this,U).call(this,o))}xyz(t,e,r){let n=Math.floor(t),s=Math.floor(e),o=Math.floor(r);const l=t-n,c=e-s,h=r-o;n=n&255,s=s&255,o=o&255;const u=a(this,I)[n+a(this,b)[s+a(this,b)[o]]].dot3(l,c,h),f=a(this,I)[n+a(this,b)[s+a(this,b)[o+1]]].dot3(l,c,h-1),w=a(this,I)[n+a(this,b)[s+1+a(this,b)[o]]].dot3(l,c-1,h),x=a(this,I)[n+a(this,b)[s+1+a(this,b)[o+1]]].dot3(l,c-1,h-1),d=a(this,I)[n+1+a(this,b)[s+a(this,b)[o]]].dot3(l-1,c,h),v=a(this,I)[n+1+a(this,b)[s+a(this,b)[o+1]]].dot3(l-1,c,h-1),E=a(this,I)[n+1+a(this,b)[s+1+a(this,b)[o]]].dot3(l-1,c-1,h),g=a(this,I)[n+1+a(this,b)[s+1+a(this,b)[o+1]]].dot3(l-1,c-1,h-1),y=a(this,U).call(this,l),$=a(this,U).call(this,c),p=a(this,U).call(this,h);return D(D(D(u,d,y),D(f,v,y),p),D(D(w,E,y),D(x,g,y),p),$)}fill(t,e){const{width:r,height:n,freq:s,setCell:o}=me(t,e);for(let l=0;l<r;l++)for(let c=0;c<n;c++){const h=l/(r/s),u=c/(r/s),f=(e==null?void 0:e.z)!==void 0?this.xyz(h,u,e==null?void 0:e.z):this.xy(h,u),w=D(0,255,fe(f));o({x:l,y:c,z:(e==null?void 0:e.z)??0,v:w})}}};b=new WeakMap,I=new WeakMap,U=new WeakMap;let Lt=Vt;var S,j,xt,W,bt,k;const M=class M{constructor(t=Math.random()){C(this,S,void 0);C(this,j,void 0);R(this,S,new Array(512)),R(this,j,new Array(512)),this.seed(t)}seed(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(let e=0;e<256;e++){let r;e&1?r=wt[e]^t&255:r=wt[e]^t>>8&255,a(this,S)[e]=a(this,S)[e+256]=r,a(this,j)[e]=a(this,j)[e+256]=de[r%12]}return this}xy(t,e){let r,n,s;const o=(t+e)*a(M,xt);let l=Math.floor(t+o),c=Math.floor(e+o);const h=(l+c)*a(M,W),u=t-l+h,f=e-c+h;let w,x;u>f?(w=1,x=0):(w=0,x=1);const d=u-w+a(M,W),v=f-x+a(M,W),E=u-1+2*a(M,W),g=f-1+2*a(M,W);l&=255,c&=255;const y=a(this,j)[l+a(this,S)[c]],$=a(this,j)[l+w+a(this,S)[c+x]],p=a(this,j)[l+1+a(this,S)[c+1]];let z=.5-u*u-f*f;z<0?r=0:(z*=z,r=z*z*y.dot2(u,f));let N=.5-d*d-v*v;N<0?n=0:(N*=N,n=N*N*$.dot2(d,v));let L=.5-E*E-g*g;return L<0?s=0:(L*=L,s=L*L*p.dot2(E,g)),70*(r+n+s)}xyz(t,e,r){let n,s,o,l;const c=(t+e+r)*a(M,bt);let h=Math.floor(t+c),u=Math.floor(e+c),f=Math.floor(r+c);const w=(h+u+f)*a(M,k),x=t-h+w,d=e-u+w,v=r-f+w;let E,g,y,$,p,z;x>=d?d>=v?(E=1,g=0,y=0,$=1,p=1,z=0):x>=v?(E=1,g=0,y=0,$=1,p=0,z=1):(E=0,g=0,y=1,$=1,p=0,z=1):d<v?(E=0,g=0,y=1,$=0,p=1,z=1):x<v?(E=0,g=1,y=0,$=0,p=1,z=1):(E=0,g=1,y=0,$=1,p=1,z=0);const N=x-E+a(M,k),L=d-g+a(M,k),$t=v-y+a(M,k),Mt=x-$+2*a(M,k),Et=d-p+2*a(M,k),At=v-z+2*a(M,k),zt=x-1+3*a(M,k),It=d-1+3*a(M,k),St=v-1+3*a(M,k);h&=255,u&=255,f&=255;const pe=a(this,j)[h+a(this,S)[u+a(this,S)[f]]],xe=a(this,j)[h+E+a(this,S)[u+g+a(this,S)[f+y]]],be=a(this,j)[h+$+a(this,S)[u+p+a(this,S)[f+z]]],ve=a(this,j)[h+1+a(this,S)[u+1+a(this,S)[f+1]]];let _=.6-x*x-d*d-v*v;_<0?n=0:(_*=_,n=_*_*pe.dot3(x,d,v));let tt=.6-N*N-L*L-$t*$t;tt<0?s=0:(tt*=tt,s=tt*tt*xe.dot3(N,L,$t));let et=.6-Mt*Mt-Et*Et-At*At;et<0?o=0:(et*=et,o=et*et*be.dot3(Mt,Et,At));let rt=.6-zt*zt-It*It-St*St;return rt<0?l=0:(rt*=rt,l=rt*rt*ve.dot3(zt,It,St)),32*(n+s+o+l)}fill(t,e){const{width:r,height:n,freq:s,setCell:o}=me(t,e);for(let l=0;l<r;l++)for(let c=0;c<n;c++){const h=l/(r/s),u=c/(r/s),f=(e==null?void 0:e.z)!==void 0?this.xyz(h,u,e==null?void 0:e.z):this.xy(h,u),w=D(0,255,fe(f));o({x:l,y:c,z:(e==null?void 0:e.z)??0,v:w})}}};S=new WeakMap,j=new WeakMap,xt=new WeakMap,W=new WeakMap,bt=new WeakMap,k=new WeakMap,C(M,xt,.5*(Math.sqrt(3)-1)),C(M,W,(3-Math.sqrt(3))/6),C(M,bt,1/3),C(M,k,1/6);let Rt=M;const Kt={Perlin:Lt,Simplex:Rt};class q{constructor(...t){throw new Error("Random contains static methods only and is not meant to be constructed")}static bool(){return Math.random()>=.5}static natural(t=G){return ue(t),Math.floor(F(0,t+1,Math.random()))}static counting(t=G){return Qt(t),Math.floor(F(1,t+1,Math.random()))}static u8(){return Math.floor(F(0,Se+1,Math.random()))}static u16(){return Math.floor(F(0,Ne+1,Math.random()))}static u32(){return Math.floor(F(0,G+1,Math.random()))}static i8(){return q.u8()+qe}static i16(){return q.u16()+De}static i32(){return q.u32()+ke}static integer({min:t=0,max:e=G}={max:G}){return Ie(t,e),Bt(t,e),Math.floor(F(t,e+1,Math.random()))}static float({min:t=0,max:e=G}={max:G}){return Bt(t,e),F(t,e+1,Math.random())}static dice(t){return Qt(t),q.integer({min:1,max:t})}static unitVector(){const t=Math.random()*2*Math.PI;return{x:Math.cos(t),y:Math.sin(t)}}static sample(t){const e=t instanceof Set?[...t]:t;if(e.length===0)return;const r=q.natural(e.length-1);return e[r]}static take(t){const e=t instanceof Set?[...t]:t;if(e.length===0)return;const r=q.natural(e.length-1),n=e[r];return t instanceof Set?t.delete(n):t.splice(r,1),n}static permute(t){for(let e=0;e<t.length-1;e++){const r=e+q.integer({max:t.length-e-1}),n=t[e];t[e]=t[r],t[r]=n}}static permutation(t){const e=[...t];for(let r=0;r<=t.length-1;r++){const n=r+q.integer({max:t.length-r-1}),s=e[r];e[r]=e[n],e[n]=s}return e}static permutationsOf(t){let e=t instanceof Set?t.size:Array.isArray(t)?t.length:t;return e===0?1:Jt(e)}static derange(t){const e=new Array(t.length).fill(!1);let r=t.length,n=r;for(;n>=2;){if(!e[r-1]){let s=0;do s=q.integer({min:1,max:r-1});while(e[s-1]);const o=t[s-1];t[s-1]=t[r-1],t[r-1]=o,Math.random()<(n-1)*q.derangementsOf(n-2)/q.derangementsOf(n)&&(e[s-1]=!0,n--),n--}r--}}static derangement(t){const e=[...t];return q.derange(e),e}static derangementsOf(t){let e=t instanceof Set?t.size:Array.isArray(t)?t.length:t;return Math.floor((Jt(e)+1)/Math.E)}}var ct,Pt;const at=class at{constructor(...t){throw new Error("Range contains static methods only and is not meant to be constructed")}static of(t,e){var c;const{from:r,to:n,step:s,produce:o}=Ct(c=at,ct,Pt).call(c,t,e),l=[];for(let h=r;r<n?h<=n:h>=n;h+=s)l.push(o(h));return l}static*lazy(t,e){var l;const{from:r,to:n,step:s,produce:o}=Ct(l=at,ct,Pt).call(l,t,e);for(let c=r;r<n?c<=n:c>=n;c+=s)yield o(c)}};ct=new WeakSet,Pt=function(t,e){let{from:r=0,to:n=0,step:s=1}=typeof t=="object"?t:{to:t};if(r===n)throw new Error("Range must be nonzero in size");if(s<=0)throw new Error("Step size must be positive, as its sign is inferred from the range");r>n&&(s*=-1);const o=e?ze(e,r)?l=>new e(l):l=>e(l):l=>l;return{from:r,to:n,step:s,produce:o}},C(at,ct);let Ft=at;const{math:gt,mtr:we,mtd:ge,mtable:Te,msub:ye,msup:sr,mrow:it,mo:B,mi:st,mn:yt}=V.tagsNS("http://www.w3.org/1998/Math/MathML");function K({matrix:i,det:t}){const e=i.data.map(n=>we({},...n.map(s=>ge(yt(s))))),r=t?["|","|"]:["[","]"];return[B(r[0]),Te({frame:"solid",rowlines:"solid",align:"axis 3"},...e),B(r[1])]}function qt({name:i,matrix:t}){const e=typeof i=="string"?st(i):ye(st(i.text),yt(i.sub));return t.data.map(r=>we({},...r.map(n=>ge(yt(n))))),gt({display:"block"},e,B("="),K({matrix:t}))}function Le(){const i=new X([[43,0,1,99,420],[7,39,-66,-4,0],[7,39,-66,-4,0]]),t=new X([[1],[1],[1],[1],[1]]);return gt({display:"block"},it({},K({matrix:i})),B("×"),it({},K({matrix:t})),B("="),it({},K({matrix:i.mul(t)})))}function Re(){const i=new X([[-2,-1,2],[2,1,4],[-3,3,-1]]);return[gt({display:"block"},st("A"),B("="),it({},K({matrix:i,det:!1}))),gt({display:"block"},ye(st("det"),st("A")),B("="),it({},K({matrix:i,det:!0})),B("="),yt(i.determinant()))]}function Fe(){return[qt({name:"S",matrix:new X([[3,2],[-6,6]])}),qt({name:{text:"I",sub:"3"},matrix:X.identity(3)}),qt({name:{text:"Z",sub:"3"},matrix:X.zero(3)}),Le(),Re()]}const{math:Pe,msup:Ue,mrow:He,mo:Z,mi:Ve,mn:Ut}=V.tagsNS("http://www.w3.org/1998/Math/MathML");function Zt({complex:i}){const{real:t,imaginary:e}=i,r=[];return(t||!e)&&(t<0&&r.push(Z("−")),r.push(Ut(Math.abs(t)))),e&&(e<0?r.push(Z("−")):t&&r.push(Z("+")),r.push(Ut(Math.abs(e)),Ve("i"))),r}function Ge(){const i=new Tt(5,-2);return Pe({display:"block"},Ue(He(Z("("),Zt({complex:i}),Z(")")),Ut(2)),Z("="),Zt({complex:i.pow(2)}))}const{math:We,mrow:Xe,mo:pt,mi:Ht,mn:ft}=V.tagsNS("http://www.w3.org/1998/Math/MathML");function Be(...i){const[t,e]=i;let{from:r=0,to:n=0,step:s=1}=typeof t=="object"?t:{to:t};return r>n&&(s*=-1),[pt("["),ft(r),Ht(","),ft(n),Ht(":"),ft(s),pt("]")]}function Yt(...i){return We({display:"block"},Xe(Be(...i),Ht("="),pt("["),...Ft.of(...i).map(t=>ft(t)),pt("]")))}function Qe(){return[Yt(5),Yt({from:13,to:9})]}const{div:Je,pre:Ot}=V.tags;function Ke(){const i=["alice","bob","carlos","dan","erin"],t=q.derangement(i);return Je(Ot(`const friends = ["alice", "bob", "carlos", "dan", "erin"];
const secretSantas = Random.derangement(friends);      `),Ot(JSON.stringify(i)),Ot(JSON.stringify(t)))}const{button:Dt,input:_t,label:te,div:ee,canvas:Ze}=V.tags;function Ye(){const r=Ze({width:400,height:400}),n=r.getContext("2d"),s=n.createImageData(400,400),o=new Kt.Perlin,l=new Kt.Simplex,c=V.state(!1),h=V.state(4);let u=0,f,w=x;function x(){o.fill(s,{freq:h.val,z:u}),n.putImageData(s,0,0),u+=.01,c.val&&(f=requestAnimationFrame(x))}const d=n.createImageData(400,400);l.fill(d,{freq:500});function v(){o.fill(s,{freq:h.val,z:u,set:({x:g,y,v:$})=>{const p=(g+y*s.width)*4,z=F(0,64,d.data[p]/256);s.data[p]=s.data[p+1]=s.data[p+2]=$+z,s.data[p+3]=255}}),n.putImageData(s,0,0),u+=.01,c.val&&(f=requestAnimationFrame(v))}function E(){o.fill(s,{freq:h.val,z:u,set:({x:g,y,z:$,v:p})=>{const z=F(0,64,(l.xyz(g/20,y/20,$)+1)/2),N=(g+y*s.width)*4;s.data[N]=s.data[N+1]=s.data[N+2]=p+z,s.data[N+3]=255}}),n.putImageData(s,0,0),u+=.01,c.val&&(f=requestAnimationFrame(E))}return w(),ee({style:"overflow-x: hidden;"},r,ee({class:"iflexy"},te("Run",_t({type:"checkbox",defaultChecked:!1,onchange:g=>{const y=g.target.checked;c.val=y,y&&w()}})),te("Freq",_t({type:"range",min:1,max:100,defaultValue:4,oninput:g=>{h.val=g.target.valueAsNumber,c.val||w()}})),Dt({onclick:()=>{cancelAnimationFrame(f),w=x,w()}},"xyz"),Dt({onclick:()=>{cancelAnimationFrame(f),w=v,w()}},"xy + xyz"),Dt({onclick:()=>{cancelAnimationFrame(f),w=E,w()}},"xyz + xyz")))}const{div:_e,main:tr,details:er,summary:rr}=V.tags;function nt(i,t,...e){return er({open:t},rr(i),_e({class:"flexy"},...e))}function nr(){return tr({},nt("Matrix",!1,Fe()),nt("Complex",!1,Ge()),nt("Range",!1,Qe()),nt("Random",!1,Ke()),nt("Noise",!0,Ye()))}V.add(document.body,nr());
